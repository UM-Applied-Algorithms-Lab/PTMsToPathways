<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cytoscape_Graphing • PTMsToPathways</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cytoscape_Graphing">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PTMsToPathways</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/PTMsToPathways.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Cytoscape_Graphing.html">Cytoscape_Graphing</a></li>
    <li><a class="dropdown-item" href="../articles/RawDataProcessing.html">Analyzing Pathways from PTMs: A Guide</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Cytoscape_Graphing</h1>
                        <h4 data-toc-skip class="author">Mark
Grimes</h4>
            
            <h4 data-toc-skip class="date">2025-09-25</h4>
      

      <div class="d-none name"><code>Cytoscape_Graphing.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="section"></h2>
</div>
<div class="section level2">
<h2 id="graphing-networks-in-cytoscape">Graphing Networks in Cytoscape<a class="anchor" aria-label="anchor" href="#graphing-networks-in-cytoscape"></a>
</h2>
<div class="section level3">
<h3 id="top-down-approach-starting-with-pathways">Top-down approach starting with pathways<a class="anchor" aria-label="anchor" href="#top-down-approach-starting-with-pathways"></a>
</h3>
<p>It is possible to graph the entire PCN, CFN, and CCCNs in their
entirety, though very large graphs take a long time to graph. One
approach to navigating these data structures is to select nodes from the
large networks in Cytoscape (or in R using RCy3::selectNodes()) and
select nearest neighbors or shortest paths and create a subnetwork in a
new window (see the Cytoscape Manual <a href="https://manual.cytoscape.org/en/stable/" class="external-link uri">https://manual.cytoscape.org/en/stable/</a>).</p>
<p>The alternative approach described below is to identify pathways,
genes, and PTMs of interest in the R data objects, then make smaller,
more interpretable graphs in Cytoscape using RCy3.</p>
<p>For example, we will find names of all pathways in Bioplanet that
contain EGFR. The data object ‘pathways.list’ is a list, where the name
of the list element is the name of a Bioplanet pathway and each element
is a character vector of the genes in that pathway. Then we want to find
interactions between the pathway “Transmembrane transport of small
molecules” and those pathways. The utility functions used below are in
CytoscapeGraphing.R</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">egfr_pathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pathways.list</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pathways.list</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="st">"EGFR"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">pathways.list</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">egfr_pathways</span><span class="op">)</span> <span class="co">#83</span></span>
<span><span class="va">egfr_transporter.pcn</span> <span class="op">&lt;-</span> <span class="fu">filter.edges.between</span><span class="op">(</span><span class="st">"Transmembrane transport of small molecules"</span>, <span class="va">egfr_pathways</span>, <span class="va">PCNedgelist</span><span class="op">)</span></span>
<span><span class="va">egfr_transporter_pcn.cy</span> <span class="op">&lt;-</span> <span class="fu">filter.edges.between</span><span class="op">(</span><span class="st">"Transmembrane transport of small molecules"</span>, <span class="va">egfr_pathways</span>, <span class="va">pathway.crosstalk.network</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">egfr_transporter.pcn</span><span class="op">)</span></span></code></pre></div>
<p>These two versions of the PCN show cluster evidence and Jaccard
smilarity in adjacent columns (the first case) or as distinct edges (the
second case, which can be used to plot this network in cytoscape).</p>
<p>Let’s zero in on interactions between proteins in the two pathways
“EGF/EGFR signaling pathway” and “Transmembrane transport of small
molecules” because they have no genes in common, yet the cluster
evidence for their interaction is strong. First we extract a network of
interactions between the genes in the two pathways. Then we generate a
node file for cytoscape. In the following case we include the data
extracted from the ptmtable. This is optional, useful if node size and
color is used later to indicate values in data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">egfr_transporter.cfn</span> <span class="op">&lt;-</span> <span class="fu">filter.edges.0</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pathways.list</span><span class="op">[[</span><span class="st">"EGF/EGFR signaling pathway"</span><span class="op">]</span><span class="op">]</span>, <span class="va">pathways.list</span><span class="op">[[</span><span class="st">"Transmembrane transport of small molecules"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="va">cfn</span><span class="op">)</span></span>
<span><span class="va">egfr_transporter.nodes</span> <span class="op">&lt;-</span> <span class="fu">make.cytoscape.node.file</span> <span class="op">(</span><span class="va">egfr_transporter.cfn</span>, <span class="va">funckey</span>, <span class="va">ptmtable</span>, include.gene.data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<p>The function GraphCfn creates a graph using the cluster filtered
network in the Cytoscape app. When graphed, Cytoscape provides an
interactive interface to view the data. This function requires the edge
list file (egfr_transporter.cfn in the example), and node data file
(egfr_transporter.nodes).</p>
<div class="section level4">
<h4 id="generating-the-graph-and-setting-node-size-and-color">Generating the graph and setting node size and color<a class="anchor" aria-label="anchor" href="#generating-the-graph-and-setting-node-size-and-color"></a>
</h4>
</div>
<div class="section level4">
<h4 id="asking-questions-about-signaling-pathways-that-connect-proteins">Asking questions about signaling pathways that connect proteins<a class="anchor" aria-label="anchor" href="#asking-questions-about-signaling-pathways-that-connect-proteins"></a>
</h4>
<p>Another example of how to use the network is to ask, what are the
paths between two nodes (two proteins)?. We use the function
connectNodes.all() to identify all shortest paths between two nodes.</p>
<p>Having identified the pathways, let’s also zoom in further on PTMs to
examine which PTMs co-cluster, as indicated by yellow edges between
them.</p>
</div>
<div class="section level4">
<h4 id="bottom-up-approach-to-investigate-how-dasatinib-affects-proteins-invovled-in-focal-adhesion">Bottom-up approach to investigate how dasatinib affects proteins
invovled in focal adhesion<a class="anchor" aria-label="anchor" href="#bottom-up-approach-to-investigate-how-dasatinib-affects-proteins-invovled-in-focal-adhesion"></a>
</h4>
<p>Dasatinib exhibits strong binding and inhibitory effects on multiple
focal adhesion-associated genes from the BioPlanet list:</p>
<p>• SRC (proto-oncogene tyrosine-protein kinase Src)</p>
<p>• FYN (tyrosine-protein kinase Fyn)</p>
<p>• EGFR (epidermal growth factor receptor)</p>
<p>• ERBB2 (receptor tyrosine-protein kinase erbB-2)</p>
<p>All these genes are directly implicated in focal adhesion signaling
regulation. We hypothesize that ptms on proteins involved in focal
adhesion will be downregulated by dasatinib.</p>
</div>
<div class="section level4">
<h4 id="node-and-edge-key">Node and Edge Key<a class="anchor" aria-label="anchor" href="#node-and-edge-key"></a>
</h4>
<p>We adopt the following standards for visualizing nodes and edges in
Cytoscape. The border and shape of the node represent the type of
protein this gene is, based on the function key (funckey).</p>
<p>Edges represent different types of interactions from PPI databases,
correlations, or links between proteins and their PTMs. The thicker the
edge is, the stronger the interaction weight.</p>
<p>Node Size:</p>
<ul>
<li>Greater the node size, larger the absolute value of the amount or
ratio</li>
</ul>
<p>Node Color:</p>
<ul>
<li>Blue Node
<ul>
<li>Negative amount or ratio<br>
</li>
</ul>
</li>
<li>Yellow Node
<ul>
<li>Positive amount or ratio<br>
</li>
</ul>
</li>
<li>Green Node
<ul>
<li>Approximately zero amount or ratio</li>
</ul>
</li>
</ul>
<p>Node Shapes:</p>
<ul>
<li>“ELLIPSE”
<ul>
<li>unknown<br>
</li>
</ul>
</li>
<li>“ROUND_RECTANGLE”
<ul>
<li>receptor tyrosine kinase<br>
</li>
</ul>
</li>
<li>“VEE”
<ul>
<li>SH2 protein<br>
</li>
<li>SH2-SH3 protein<br>
</li>
</ul>
</li>
<li>“TRIANGLE”
<ul>
<li>SH3 protein<br>
</li>
</ul>
</li>
<li>“HEXAGON”
<ul>
<li>tyrosine kinase<br>
</li>
</ul>
</li>
<li>“DIAMOND”
<ul>
<li>SRC-family kinase<br>
</li>
</ul>
</li>
<li>“OCTAGON”
<ul>
<li>kinase<br>
</li>
<li>phosphatase<br>
</li>
</ul>
</li>
<li>“PARALLELOGRAM”
<ul>
<li>transcription factor<br>
</li>
</ul>
</li>
<li>“RECTANGLE”
<ul>
<li>RNA binding protein</li>
</ul>
</li>
</ul>
<p>Node Border Colors:</p>
<ul>
<li>Orange
<ul>
<li>deacetylase<br>
</li>
<li>acetyltransferase<br>
</li>
</ul>
</li>
<li>Blue
<ul>
<li>demethylase<br>
</li>
<li>methyltransferase<br>
</li>
</ul>
</li>
<li>Royal Purple
<ul>
<li>membrane protein<br>
</li>
</ul>
</li>
<li>Red
<ul>
<li>kinase<br>
</li>
<li>tyrosine kinase<br>
</li>
<li>SRC-family kinase<br>
</li>
</ul>
</li>
<li>Yellow
<ul>
<li>phosphatase<br>
</li>
<li>tyrosine phosphatase<br>
</li>
</ul>
</li>
<li>Lilac
<ul>
<li>G protein-coupled receptor<br>
</li>
<li>receptor tyrosine kinase<br>
</li>
</ul>
</li>
<li>Grey
<ul>
<li>default</li>
</ul>
</li>
</ul>
<p>Edge Colors:</p>
<ul>
<li>Red
<ul>
<li>Phosphorylation<br>
</li>
<li>pp<br>
</li>
<li>controls-phosphorylation-of<br>
</li>
</ul>
</li>
<li>Bright Magenta
<ul>
<li>controls-expression-of<br>
</li>
</ul>
</li>
<li>Dull Magenta
<ul>
<li>controls-transport-of<br>
</li>
</ul>
</li>
<li>Purple
<ul>
<li>controls-state-change-of<br>
</li>
</ul>
</li>
<li>Blood Orange
<ul>
<li>Acetylation<br>
</li>
</ul>
</li>
<li>Lime Green
<ul>
<li>Physical interactions<br>
</li>
</ul>
</li>
<li>Green
<ul>
<li>BioPlex<br>
</li>
</ul>
</li>
<li>Dull Green
<ul>
<li>in-complex-with<br>
</li>
</ul>
</li>
<li>Seafoam Green
<ul>
<li>experiments<br>
</li>
<li>experiments_transferred<br>
</li>
</ul>
</li>
<li>Cyan
<ul>
<li>database<br>
</li>
<li>database_transferred<br>
</li>
</ul>
</li>
<li>Teal
<ul>
<li>Pathway<br>
</li>
<li>Predicted<br>
</li>
</ul>
</li>
<li>Dark Turquoise
<ul>
<li>Genetic interactions<br>
</li>
</ul>
</li>
<li>Yellow-Orange
<ul>
<li>correlation<br>
</li>
</ul>
</li>
<li>Royal Blue
<ul>
<li>negative correlation<br>
</li>
</ul>
</li>
<li>Bright Yellow
<ul>
<li>positive correlation<br>
</li>
</ul>
</li>
<li>Grey
<ul>
<li>combined_amount or ratio<br>
</li>
</ul>
</li>
<li>Dark Grey
<ul>
<li>merged<br>
</li>
</ul>
</li>
<li>Light Grey
<ul>
<li>intersect<br>
</li>
</ul>
</li>
<li>Black
<ul>
<li>peptide<br>
</li>
</ul>
</li>
<li>Orange
<ul>
<li>homology<br>
</li>
</ul>
</li>
<li>Dull Orange
<ul>
<li>Shared protein domains<br>
</li>
</ul>
</li>
<li>White
<ul>
<li>Default</li>
</ul>
</li>
</ul>
<p>Arrow Types:</p>
<ul>
<li>
<p>Arrow</p>
<ul>
<li>Phosphorylation<br>
</li>
<li>pp<br>
</li>
<li>controls-phosphorylation-of<br>
</li>
<li>controls-expression-of<br>
</li>
<li>controls-transport-of<br>
</li>
<li>controls-state-change-of<br>
</li>
<li>Acetylation<br>
</li>
</ul>
</li>
<li>
<p>No Arrow</p>
<ul>
<li>Default</li>
</ul>
<p>These properties can be visualized in Cytoscape using the
NodeEdgeKey() function:</p>
</li>
</ul>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Grimes, Mikhail Ukrainetz, Grant Smith, Madison Moffett, Nagashree Avabhrath, Lucia Williams.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
