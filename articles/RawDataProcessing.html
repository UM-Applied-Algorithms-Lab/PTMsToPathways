<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analyzing Pathways from PTMs: A Guide • PTMsToPathways</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing Pathways from PTMs: A Guide">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PTMsToPathways</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/RawDataProcessing.html">Raw Data Processing</a></li>
    <li><a class="dropdown-item" href="../articles/CreatingNetworks.html">Creating Networks</a></li>
    <li><a class="dropdown-item" href="../articles/CytoscapeGraphing.html">Cytoscape Graphing</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analyzing Pathways from PTMs: A Guide</h1>
                        <h4 data-toc-skip class="author">Lucia Williams,
Nagashree Avabhrath, Mikhail Ukrainetz, Madison Moffett, Grant Smith,
Mark Grimes</h4>
            
      

      <div class="d-none name"><code>RawDataProcessing.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>This vignette intends to help users produce a matrix with PTM names
as row names (e.g. FYN p Y411) and numeric data in all the columns,
which can be used as input to the PTMsToPathways functions.</p>
<p>Mass spectrometry data output will vary depending on the experimental
design, source of data, and software used to process the raw spectra. R
supports many file types and can automatically convert them into a data
frame. For example, <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code> will take a csv file and
convert it into a data frame (<code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code> is a variation of
<code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table()</a></code>). We start with data in tab-delimited
spreadsheet format.</p>
</div>
<div class="section level2">
<h2 id="naming-conventions">Naming conventions<a class="anchor" aria-label="anchor" href="#naming-conventions"></a>
</h2>
<p>In this vignette, we use the following shorthand conventions when
describing PTMs based on the modifications present in the example data
set. Your data will dictate the names of modifications.</p>
<ul>
<li>
<em>Gene.Name</em> = The HUGO Gene Name is used to identify the
protein/gene</li>
<li>
<em>Phosphorylation</em> = “p”</li>
<li>
<em>Lysine acetylation</em> = “ack”</li>
<li>
<em>Lysine methylation</em> = “kme”</li>
<li>
<em>Arginine methylation</em> = “rme”</li>
<li>
<em>Ubiquitination</em> = “ubi”</li>
</ul>
</div>
<div class="section level2">
<h2 id="data-input">Data input<a class="anchor" aria-label="anchor" href="#data-input"></a>
</h2>
<p>Investigators will need to identify which columns contain key
information for analysis of PTMs. The example raw data file for this
vignette (downloadable <a href="https://github.com/UM-Applied-Algorithms-Lab/PTMsToPathways/raw/refs/heads/main/inst/extdata/phospho_cleaned_mapped.txt" class="external-link">here</a>,
or load directly into R using the commands below) contains only
phosphorylation sites.</p>
<ul>
<li>“Amino Acid” has the modified amino acid, e.g. S,T, etc.</li>
<li>“Positions Within Proteins” is the amino acid number in the protein
sequence.</li>
<li>Ambiguous modification sites (a modification site whose peptide
sequence is the same in more than one protein) have multiple possible
postions separated by “;”.</li>
<li>“Modification Type” has Phosphorylation” etc.</li>
</ul>
<p>Note that R converts spaces in column names to periods. After reading
in our data table, the relevant column names are:</p>
<p><strong>genes</strong> = “AllGeneSymbols”</p>
<p><strong>positions</strong> = “Positions.Within.Proteins”</p>
<p><strong>aa</strong> = “Amino.Acid”</p>
<p><strong>modification</strong> = “Modification.Type”</p>
<p>We provide a helper function <code>name.peptide()</code> to make a
PTM name using these columns. This function concatenates ambiguous
modification sites and ignores NA values that are present in cells or
ambiguous gene names.</p>
<p>Note that it is very important that the rownames are the names of
post-translational modifications. All of their respective columns are
the experimental conditions under which the post-translational
modifications occurred. The numeric values are data output by the mass
spectrometer. NAs – which are importantly not zeroes – represent missing
data. Ambigious PTMs, cases where a PTM could be any one of several
PTMs, are separated by semicolons. (e.g. “AARS ubi k747; AMBLIL p
U123”).</p>
<p>Many investigators will examine their data in Microsoft Excel, which
can export the spreadsheet in tab- or comma-delimited format.
Unfortunately, Excel inescapably turns some gene names into dates when
present in a cell by themselves. We reverse this with an example helper
function, <code>fix.excel()</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fix.excel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">cell</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fixgenes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CDC2"</span>, <span class="st">"1-Sep"</span>, <span class="st">"2-Sep"</span>, <span class="st">"3-Sep"</span>, <span class="st">"4-Sep"</span>, <span class="st">"5-Sep"</span>, <span class="st">"7-Sep"</span>,</span>
<span>               <span class="st">"8-Sep"</span>, <span class="st">"9-Sep"</span>, <span class="st">"10-Sep"</span>, <span class="st">"11-Sep"</span>, <span class="st">"15-Sep"</span>, <span class="st">"6-Sep"</span>, <span class="st">"1-Oct"</span>,</span>
<span>               <span class="st">"2-Oct"</span>, <span class="st">"3-Oct"</span>, <span class="st">"4-Oct"</span>, <span class="st">"6-Oct"</span>, <span class="st">"7-Oct"</span>, <span class="st">"11-Oct"</span>, <span class="st">"1-Mar"</span>,</span>
<span>               <span class="st">"2-Mar"</span>, <span class="st">"3-Mar"</span>, <span class="st">"4-Mar"</span>, <span class="st">"5-Mar"</span>, <span class="st">"6-Mar"</span>, <span class="st">"7-Mar"</span>, <span class="st">"8-Mar"</span>,</span>
<span>               <span class="st">"9-Mar"</span>, <span class="st">"10-Mar"</span>, <span class="st">"11-Mar"</span>, <span class="st">"C11orf58"</span>, <span class="st">'C17orf57'</span>, <span class="st">'C3orf10'</span>,</span>
<span>               <span class="st">'C7orf51'</span>, <span class="st">"C11orf59"</span>, <span class="st">"C4orf16"</span>, <span class="st">"1-Dec"</span>, <span class="st">"14-Sep"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">corrects</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CDK1"</span>, <span class="st">"SEPT1"</span>, <span class="st">"SEPT2"</span>, <span class="st">"SEPT3"</span>, <span class="st">"SEPT4"</span>, <span class="st">"SEPT5"</span>, <span class="st">"SEPT7"</span>,</span>
<span>               <span class="st">"SEPT8"</span>, <span class="st">"SEPT9"</span>, <span class="st">"SEPT10"</span>, <span class="st">"SEPT11"</span>, <span class="st">"SEPT15"</span>, <span class="st">"SEPT6"</span>,</span>
<span>               <span class="st">"POU2F1"</span>, <span class="st">"POU2F2"</span>, <span class="st">"POU5F1"</span>, <span class="st">"POU5F1"</span>, <span class="st">"POU3F1"</span>, <span class="st">"POU3F2"</span>,</span>
<span>               <span class="st">"POU2F3"</span>, <span class="st">"MARCH1"</span>, <span class="st">"MARCH2"</span>, <span class="st">"MARCH3"</span>, <span class="st">"MARCH4"</span>, <span class="st">"MARCH5"</span>,</span>
<span>               <span class="st">"MARCH6"</span>, <span class="st">"MARCH7"</span>, <span class="st">"MARCH8"</span>, <span class="st">"MARCH9"</span>, <span class="st">"MARCH10"</span>, <span class="st">"MARCH11"</span>,</span>
<span>               <span class="st">"SMAP"</span>, <span class="st">"EFCAB13"</span>, <span class="st">"BRK1"</span>, <span class="st">"NYAP1"</span>, <span class="st">"LAMTOR1"</span>, <span class="st">'AP1AR'</span>, <span class="st">"DEC1"</span>,</span>
<span>               <span class="st">"SEPT14"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">cellv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span>, <span class="st">"; "</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">fixgenes</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">cellv</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">cellv.new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="va">fixgenes</span><span class="op">[</span><span class="va">fixgenes</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">cellv</span><span class="op">]</span>,</span>
<span>                      <span class="va">corrects</span><span class="op">[</span><span class="va">fixgenes</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">cellv</span><span class="op">]</span>, <span class="va">cellv</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">cellv.new</span>, collapse<span class="op">=</span><span class="st">"; "</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span></code></pre></div>
<p>We provide another example helper function,
<code>name.peptide()</code>, to handle ambiguous modification sites (a
modification site whose peptide sequence is the same in more than one
protein) separated by “;” or another separator.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">name.peptide</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">genes</span>, <span class="va">modification</span><span class="op">=</span><span class="st">"p"</span>, <span class="va">sites</span>, <span class="va">aa</span>, <span class="va">pepsep</span><span class="op">=</span><span class="st">";"</span><span class="op">)</span>   <span class="op">{</span></span>
<span>  <span class="va">genes.v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">genes</span>, <span class="va">pepsep</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">genes.v</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">genes.v</span> <span class="op">==</span> <span class="st">"NA"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>  <span class="va">genes.v</span> <span class="op">&lt;-</span> <span class="va">genes.v</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">genes.v</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">sites.v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">sites</span>, <span class="va">pepsep</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">sites.v</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">sites.v</span> <span class="op">==</span> <span class="st">"NA"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>  <span class="va">sites.v</span> <span class="op">&lt;-</span> <span class="va">sites.v</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sites.v</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">sites.v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sites.v</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span> <span class="op">(</span><span class="va">aa</span>, <span class="va">x</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Peptide.v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/noquote.html" class="external-link">noquote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>    <span class="va">genes.v</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">genes.v</span><span class="op">)</span><span class="op">]</span>, <span class="va">modification</span>,</span>
<span>    <span class="va">sites.v</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sites.v</span><span class="op">)</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">" "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Peptide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Peptide.v</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">"; "</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">Peptide</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Read in data file that is output from mass spectrometry. If you have
installed the PTMsToPathways package, you can use the example data file
included in the package as below. To use your own data file, replace
<code>file_path</code> variable with your own path to file, as in the
commented line below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># file_path &lt;- "path/to/your/file.txt"</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"phospho_cleaned_mapped.txt"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                         <span class="at">package =</span> <span class="st">"PTMsToPathways"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>newphos <span class="ot">&lt;-</span> <span class="fu">read.table</span>(file_path, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">skip =</span> <span class="dv">0</span>, <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                      <span class="at">blank.lines.skip =</span> T, <span class="at">fill =</span> T, <span class="at">quote =</span> <span class="st">"</span><span class="sc">\"</span><span class="st">"</span>, <span class="at">dec =</span> <span class="st">"."</span>,</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>                      <span class="at">comment.char =</span> <span class="st">""</span>, <span class="at">stringsAsFactors =</span> F)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="fu">dim</span>(newphos)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="dv">933</span> <span class="dv">170</span></span></code></pre></div>
<p>First remove internal control rows (reverse sequences).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>newphos <span class="ot">&lt;-</span> newphos[<span class="sc">!</span><span class="fu">is.na</span>(newphos<span class="sc">$</span>AllGeneSymbols),]</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">dim</span>(newphos)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="dv">908</span> <span class="dv">170</span></span></code></pre></div>
<p>If there are dates in the <code>AllGeneSymbols</code> column,
use:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newphos</span><span class="op">$</span><span class="va">AllGeneSymbols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">newphos</span><span class="op">$</span><span class="va">AllGeneSymbols</span>, <span class="va">fix.excel</span><span class="op">)</span></span></code></pre></div>
<p>Next, identify the columns that will be used to name the PTM</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">headercols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AllGeneSymbols"</span>, <span class="st">"Amino.Acid"</span>,</span>
<span>                <span class="st">"Positions.Within.Proteins"</span>, <span class="st">"Modification.Type"</span><span class="op">)</span></span></code></pre></div>
<p>Make a separate data frame using these columns.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newphos.head</span> <span class="op">&lt;-</span> <span class="va">newphos</span><span class="op">[</span>,<span class="va">headercols</span><span class="op">]</span></span></code></pre></div>
<p>Now create a unique PTM name (peptide name)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newphos.head</span><span class="op">$</span><span class="va">Peptide.Name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span></span>
<span>  <span class="va">name.peptide</span>, genes <span class="op">=</span> <span class="va">newphos.head</span><span class="op">$</span><span class="va">AllGeneSymbols</span>,</span>
<span>  sites <span class="op">=</span>  <span class="va">newphos.head</span><span class="op">$</span><span class="va">Positions.Within.Proteins</span>, aa <span class="op">=</span> <span class="va">newphos.head</span><span class="op">$</span><span class="va">Amino.Acid</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="replacing-patterns">Replacing Patterns<a class="anchor" aria-label="anchor" href="#replacing-patterns"></a>
</h4>
<p>If the list of PTMs possesses symbols that are unnecessary such as
“AARS ~K ubi K747”, this command will remove all strings included in the
“patterns” vector from the rownames. Any pattern can be chosen so long
as the user ensures that any special character (such as $ or @) have a
“\” in front of them.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">patterns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"\\~"</span>, <span class="st">"\\#"</span>, <span class="st">"/"</span>, <span class="st">"\\$"</span>, <span class="st">"\\@"</span>, <span class="st">"\\|"</span><span class="op">)</span></span>
<span><span class="va">patterns</span> <span class="op">&lt;-</span> <span class="va">patterns</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">patterns</span><span class="op">)</span>, <span class="va">patterns</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">newphos</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">newphos</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">p</span> <span class="kw">in</span> <span class="va">patterns</span><span class="op">)</span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="va">p</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="data-columns">Data columns<a class="anchor" aria-label="anchor" href="#data-columns"></a>
</h4>
<p>Next we identify the data columns, which contain the string
“Intensity.” The example data file is from a multi-PTM study and the
data in this table are from just the phosphorylation pulldown (other
tables are for other PTM types). The optimal pulldown columns are
straightforward to identify by the pulldown strings present in the
sample names, “pTyr” in this case. They are also identifiable by zooming
out and looking at the patterns of missing data, the optimal pulldowns,
as a group, have the least missing data. The second step is to select
colums that have “pTyr.”</p>
<p>These data have technical replicates, which means that the same
samples were run twice. Due to the stochastic selection of peptides for
detection, the pattern of missing values is slightly different between
technical replicates. We therefore merge the technical replicates taking
the value of either replicate where it’s missing in the other, and
averaging values detected in both, using the function,
<em>merge2cols()</em>.</p>
</div>
</div>
<div class="section level2">
<h2 id="key-for-column-names">Key for column names<a class="anchor" aria-label="anchor" href="#key-for-column-names"></a>
</h2>
<p><strong>C</strong> = Crizotinib</p>
<p><strong>D</strong> = DMSO</p>
<p><strong>E</strong> = Erlotinib</p>
<p><strong>Pr</strong> = PR171</p>
<p><strong><em>For Intensity columns</em></strong></p>
<p><em>C1-1</em>: Crizotinib biological replicate 1- technical replicate
1</p>
<p><em>C1-2</em>: Crizotinib biological replicate 1- technical replicate
2</p>
<p><em>C2-1</em>: Crizotinib biological replicate 2- technical replicate
1</p>
<p><em>C2-2</em>: Crizotinib biological replicate 2- technical replicate
2</p>
<p><em>C3-1</em>: Crizotinib biological replicate 3- technical replicate
1</p>
<p><em>C3-2</em>: Crizotinib biological replicate 3- technical replicate
2</p>
<p>… &amp; similar for other drugs</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phosdata</span> <span class="op">&lt;-</span> <span class="va">newphos</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Intensity"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">newphos</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">phosdata</span> <span class="op">&lt;-</span> <span class="va">phosdata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"pTyr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Now simplify column names:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"Intensity."</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Make zero into NA, which it is. (Note that this may not apply if you
are confident that zero means actual zero, which is possible with
certain technical advances like DIA.)</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zer0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">phosdata</span><span class="op">==</span><span class="fl">0</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">phosdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span> <span class="op">(</span><span class="va">phosdata</span>, <span class="va">zer0</span>, <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p>Define technical replicates:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tr1.opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">".1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata</span><span class="op">)</span>, fixed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">tr2.opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">".2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata</span><span class="op">)</span>, fixed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Use this function to average technical replicates. This function
ignores NA values in either column and takes the average in the case
where there are two values.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">merge2cols</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">colv1</span>, <span class="va">colv2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">newcolv</span><span class="op">=</span><span class="cn">NA</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">colv1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">colv2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">newcolv</span><span class="op">=</span><span class="cn">NA</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">newcolv</span><span class="op">)</span><span class="op">}</span> <span class="kw">else</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">colv1</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">colv2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">newcolv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">colv1</span>, <span class="va">colv2</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">newcolv</span><span class="op">)</span> <span class="op">}</span> <span class="kw">else</span></span>
<span>          <span class="va">newcolv</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">colv1</span> <span class="op">+</span> <span class="va">colv2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">newcolv</span><span class="op">)</span> <span class="op">}</span></span>
<span></span>
<span><span class="co"># Use merge2cols() function to average technical replicates:</span></span>
<span><span class="va">phosdata.merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">phosdata</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">18</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tr1.opt</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">phosdata.merged</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="va">merge2cols</span>,</span>
<span>                                colv1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">phosdata</span><span class="op">[</span>, <span class="va">tr1.opt</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                colv2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">phosdata</span><span class="op">[</span>,<span class="va">tr2.opt</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata.merged</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tr1.opt</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">x</span>, start<span class="op">=</span><span class="fl">1</span>, stop<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Merge with header:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phosdatafile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">newphos.head</span>, <span class="va">phosdata.merged</span><span class="op">)</span></span></code></pre></div>
<p>This file could be saved for reference using
<code><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table()</a></code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">phosdatafile</span>, file <span class="op">=</span> <span class="st">"phosdatafile.txt"</span>,</span>
<span>            row.names <span class="op">=</span> <span class="cn">FALSE</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span></code></pre></div>
<p>For subsequent steps, we make a dataframe withjust the data with
individual PTMs as rownames:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">phosdatafile</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">phosdatafile</span><span class="op">$</span><span class="va">Peptide.Name</span></span>
<span><span class="va">phosdata.df</span> <span class="op">&lt;-</span> <span class="va">phosdatafile</span><span class="op">[</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">23</span><span class="op">]</span></span></code></pre></div>
<p>Log base 2 transformation improves clustering.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log2phosdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">phosdata.df</span><span class="op">)</span></span></code></pre></div>
<p>The following vignettes show how to use the functions provided in
PTMsToPathways to analyze data stored in a variable called
<code>ptmtable</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ptmtable &lt;- log2phosdata</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="optional-data-processing-steps">Optional data processing steps<a class="anchor" aria-label="anchor" href="#optional-data-processing-steps"></a>
</h2>
<p>For experiments where treatment with drugs is compared to control
samples, adding treatment/control ratios as additional data column can
improve clustering. This optional step adds dimensions to the data set
that enhance focus on the changes in response to drug treatments.</p>
<p>Simplify column names first:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata.df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata.df</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"SEPTM_pTyr"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"SEPTM_pTyr"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Explore using ratios where control=rowMeans (D1, D2, D3):</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">H3122control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">phosdata.df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata.df</span><span class="op">)</span></span>
<span>                                     <span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"H3122.D"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata.df</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                         na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Change NaN to NA</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">H3122control</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">H3122control</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">PC9control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">phosdata.df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata.df</span><span class="op">)</span></span>
<span>                                   <span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"PC9.D"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phosdata.df</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PC9control</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">PC9control</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>Calculate treatment/control ratios</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># H3122 cells</span></span>
<span><span class="va">H3122.C1.ratio</span> <span class="op">&lt;-</span> <span class="va">phosdata.df</span><span class="op">$</span><span class="va">H3122.C1</span><span class="op">/</span><span class="va">H3122control</span></span>
<span><span class="va">H3122.C2.ratio</span> <span class="op">&lt;-</span> <span class="va">phosdata.df</span><span class="op">$</span><span class="va">H3122.C2</span><span class="op">/</span><span class="va">H3122control</span></span>
<span><span class="va">H3122.C3.ratio</span> <span class="op">&lt;-</span> <span class="va">phosdata.df</span><span class="op">$</span><span class="va">H3122.C3</span><span class="op">/</span><span class="va">H3122control</span></span>
<span><span class="va">H3122.PR1.ratio</span> <span class="op">&lt;-</span> <span class="va">phosdata.df</span><span class="op">$</span><span class="va">H3122.PR1</span><span class="op">/</span><span class="va">H3122control</span></span>
<span><span class="va">H3122.PR2.ratio</span> <span class="op">&lt;-</span> <span class="va">phosdata.df</span><span class="op">$</span><span class="va">H3122.PR2</span><span class="op">/</span><span class="va">H3122control</span></span>
<span><span class="va">H3122.PR3.ratio</span> <span class="op">&lt;-</span> <span class="va">phosdata.df</span><span class="op">$</span><span class="va">H3122.PR3</span><span class="op">/</span><span class="va">H3122control</span></span>
<span></span>
<span><span class="co"># PC9 cells</span></span>
<span><span class="va">PC9.E1.ratio</span> <span class="op">&lt;-</span> <span class="va">phosdata.df</span><span class="op">$</span><span class="va">PC9.E1</span><span class="op">/</span><span class="va">PC9control</span></span>
<span><span class="va">PC9.E2.ratio</span> <span class="op">&lt;-</span> <span class="va">phosdata.df</span><span class="op">$</span><span class="va">PC9.E2</span><span class="op">/</span><span class="va">PC9control</span></span>
<span><span class="va">PC9.E3.ratio</span> <span class="op">&lt;-</span> <span class="va">phosdata.df</span><span class="op">$</span><span class="va">PC9.E3</span><span class="op">/</span><span class="va">PC9control</span></span>
<span><span class="va">PC9.PR1.ratio</span> <span class="op">&lt;-</span> <span class="va">phosdata.df</span><span class="op">$</span><span class="va">PC9.PR1</span><span class="op">/</span><span class="va">PC9control</span></span>
<span><span class="va">PC9.PR2.ratio</span> <span class="op">&lt;-</span> <span class="va">phosdata.df</span><span class="op">$</span><span class="va">PC9.PR2</span><span class="op">/</span><span class="va">PC9control</span></span>
<span><span class="va">PC9.PR3.ratio</span> <span class="op">&lt;-</span> <span class="va">phosdata.df</span><span class="op">$</span><span class="va">PC9.PR3</span><span class="op">/</span><span class="va">PC9control</span></span></code></pre></div>
<p>Put these columns in a data frame:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phos_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">H3122.C1.ratio</span>, <span class="va">H3122.C2.ratio</span>, <span class="va">H3122.C3.ratio</span>,</span>
<span>                          <span class="va">H3122.PR1.ratio</span>, <span class="va">H3122.PR2.ratio</span>, <span class="va">H3122.PR3.ratio</span>,</span>
<span>                          <span class="va">PC9.E1.ratio</span>, <span class="va">PC9.E2.ratio</span>, <span class="va">PC9.E3.ratio</span>,</span>
<span>                          <span class="va">PC9.PR1.ratio</span>, <span class="va">PC9.PR2.ratio</span>, <span class="va">PC9.PR3.ratio</span><span class="op">)</span></span></code></pre></div>
<p>Check (should be <code>TRUE</code>):</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(phosdata.df), <span class="fu">rownames</span>(phos_ratios))</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
<p>Make limits to unweight extreme values. This has been shown to
improve clustering, and a ratio of 1000 is biologically not really
functional different than a ratio of 100.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hi.ratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">phos_ratios</span> <span class="op">&gt;=</span> <span class="fl">100</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">low.ratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">phos_ratios</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">phos_ratios.lim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span> <span class="op">(</span><span class="va">phos_ratios</span>, <span class="va">hi.ratio</span>, <span class="fl">100</span><span class="op">)</span> </span>
<span><span class="va">phos_ratios.lim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span> <span class="op">(</span><span class="va">phos_ratios.lim</span>, <span class="va">low.ratio</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span> </span></code></pre></div>
<p>log2 transformation improves clustering:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phos_ratios.lim.log2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">phos_ratios.lim</span><span class="op">)</span></span>
<span><span class="va">phosdata_plus_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">log2phosdata</span>, <span class="va">phos_ratios.lim.log2</span><span class="op">)</span></span></code></pre></div>
<p>And plot to check:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">phosdata_plus_ratios</span><span class="op">)</span></span></code></pre></div>
<p><img src="plots/unnamed-chunk-24-1.png" class="r-plt" width="100%" style="display: block; margin: auto;">
And do one more check:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(phos_ratios.lim.log2), <span class="fu">rownames</span>(log2phosdata)) </span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
<p>This can be used as the example ptmtable for subsequent testing.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ptmtable &lt;- phosdata_plus_ratios</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="combining-data-from-multiple-ptm-experiments">Combining data from multiple PTM experiments<a class="anchor" aria-label="anchor" href="#combining-data-from-multiple-ptm-experiments"></a>
</h2>
<p>For experiments involving multiple PTMs, or if investigators wish to
combine several data sets, the data can be combined. For example,
pulldowns were made to isolate acetylated and ubiquitinated peptides
from the same experimental samples. Combining the data is simply
repeating the above steps using the correct optimum data columns, then
making the column names the same, and binding all the rows together.</p>
<p>Suppose you had acetylation data in <code>ackdata.df</code> and
ubiquitination data in <code>ubidata.df</code>, both formatted as above
for phosphorylation data in <code>phosdata.df</code>. You could combine
them as follows.</p>
<p>First, make sure the column names are the same:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kgp</span> <span class="op">&lt;-</span> <span class="va">phosdata.df</span></span>
<span><span class="va">kga</span> <span class="op">&lt;-</span> <span class="va">ackdata.df</span></span>
<span><span class="va">kgu</span> <span class="op">&lt;-</span> <span class="va">ubidata.df</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">kgp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">kgp</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"_pTyr"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"_pTyr"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>        sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">kga</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">kga</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"_AcK"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"_AcK"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>        sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">kgu</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">kgu</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"_Ubi"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"_Ubi"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>        sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">kgp</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">kga</span><span class="op">)</span><span class="op">)</span> <span class="co"># Check TRUE</span></span></code></pre></div>
<p>Then <code>rbind</code> them:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ptmdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span> <span class="op">(</span><span class="va">kgp</span>, <span class="va">kga</span>, <span class="va">kgu</span><span class="op">)</span> </span></code></pre></div>
<p>Reorder:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ptmdata</span> <span class="op">&lt;-</span> <span class="va">ptmdata</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ptmdata</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>This optional step improves clustering in our hands:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log2ptmdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">ptmdata</span><span class="op">)</span></span></code></pre></div>
<p>Finally, this dataframe could be used as the example
<code>ptmtable</code> for the P2P functions.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ptmtable &lt;- log2ptmdata</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Grimes, Mikhail Ukrainetz, Grant Smith, Madison Moffett, Nagashree Avabhrath, Lucia Williams.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
