<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using the P2P Package: A Step-by-Step Tutorial • PTMsToPathways</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using the P2P Package: A Step-by-Step Tutorial">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PTMsToPathways</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/RawDataProcessing.html">Raw Data Processing</a></li>
    <li><a class="dropdown-item" href="../articles/PTMsToPathways.html">PTMs To Pathways</a></li>
    <li><a class="dropdown-item" href="../articles/Cytoscape_Graphing.html">Cytoscape Graphing</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using the P2P Package: A Step-by-Step Tutorial</h1>
                        <h4 data-toc-skip class="author">Nagashree
Avabhrath, Mikhail Ukrainetz, Madison Moffett, Grant Smith, Lucia
Williams, Mark Grimes</h4>
            
      

      <div class="d-none name"><code>PTMsToPathways.Rmd</code></div>
    </div>

    
    
<p>This tutorial is intended to be a step-by-step guide to walk users
through the process of using the P2P package. It includes descriptions
of each function and must be run in order as subsequent steps require
the data produced in previous steps. Example code and example outputs as
well as estimated run-times are included with each description and are
based on a preliminary dataset of ~9000 PTMs and 69 experimental
conditions processed with a 12th Gen i7 processor and 16GB of RAM.</p>
<p><strong>An important note:</strong> The returned outputs from the
functions are data that may be saved in an RData object so that the user
may reload the data, which may take a while to generate, and pick up
where they left off later. See the bottom of this document for code to
save your data efficiently.</p>
<div class="section level2">
<h2 id="installing-the-package">Installing the Package<a class="anchor" aria-label="anchor" href="#installing-the-package"></a>
</h2>
<p>You will need to install the devtools package, which can be installed
with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span></code></pre></div>
<p>Next, install the package with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"UM-Applied-Algorithms-Lab/PTMsToPathways"</span><span class="op">)</span></span></code></pre></div>
<p>And load the package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://um-applied-algorithms-lab.github.io/PTMsToPathways/">PTMsToPathways</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="starting-data">Starting Data<a class="anchor" aria-label="anchor" href="#starting-data"></a>
</h2>
<p>For the tutorial, we will be using two example datasets: a smaller
dataset consisting of 933 PTMs and 18 experimental conditions (the
example used in the <a href="RawDataProcessing.html">Raw Data Processing
vignette</a>) and a larger dataset containing around 9000 PTMs and 69
experimental conditions. These datasets are available with the package.
Alternatively, the larger dataset can be downloaded <a href="https://github.com/UM-Applied-Algorithms-Lab/PTMsToPathways/raw/refs/heads/main/inst/extdata/AlldataPTMs.txt" class="external-link">here</a>
to be inspected locally.</p>
<p>To see all data that is provided with the package, run:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"PTMsToPathways"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="58%">
<col width="41%">
</colgroup>
<thead><tr class="header">
<th align="left">Dataset Name</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ex.CPE.matrix (CPE_matrix)</td>
<td align="left">CPE matrix example</td>
</tr>
<tr class="even">
<td align="left">ex.Jaccard.Full (Jaccard_Full)</td>
<td align="left">Jaccard Example</td>
</tr>
<tr class="odd">
<td align="left">ex.PTPedgelist (PTPedgelist)</td>
<td align="left">PTP Edgelist Example</td>
</tr>
<tr class="even">
<td align="left">ex.all.tsne.coords (all_tsne_coords)</td>
<td align="left">All Tsne Coords</td>
</tr>
<tr class="odd">
<td align="left">ex.bioplanet (bioplanet)</td>
<td align="left">Bioplanet Example</td>
</tr>
<tr class="even">
<td align="left">ex.cfn (cfn)</td>
<td align="left">Cluster Filtered Network Example</td>
</tr>
<tr class="odd">
<td align="left">ex.clusters.list (clusters_list)</td>
<td align="left">Clusters List Example</td>
</tr>
<tr class="even">
<td align="left">ex.common.clusters (common_clusters)</td>
<td align="left">List of Common Clusters Example</td>
</tr>
<tr class="odd">
<td align="left">ex.funckey (funckey)</td>
<td align="left">Funckey</td>
</tr>
<tr class="even">
<td align="left">ex.gene.cccn (gene_cccn)</td>
<td align="left">Gene CoCluster Network example</td>
</tr>
<tr class="odd">
<td align="left">ex.gm.edges (gm_edges)</td>
<td align="left">Full GeneMANIA Edges Example</td>
</tr>
<tr class="even">
<td align="left">ex.gm.network (gm_network)</td>
<td align="left">Full GeneMANIA Network Example</td>
</tr>
<tr class="odd">
<td align="left">ex.gm.nodes (gm_nodes)</td>
<td align="left">GeneMANIA Nodes Example</td>
</tr>
<tr class="even">
<td align="left">ex.nodenames (nodenames)</td>
<td align="left">Nodenames Example</td>
</tr>
<tr class="odd">
<td align="left">ex.pathways.list (pathways_list)</td>
<td align="left">Pathways List Example</td>
</tr>
<tr class="even">
<td align="left">ex.ppi.network (ppi_network)</td>
<td align="left">PPI Network Example</td>
</tr>
<tr class="odd">
<td align="left">ex.ptm.cccn (ptm_cccn)</td>
<td align="left">Filtered Correlation Matrix example</td>
</tr>
<tr class="even">
<td align="left">ex.ptm.correlation.matrix (ptm_correlation_matrix)</td>
<td align="left">Correlation Matrix Example</td>
</tr>
<tr class="odd">
<td align="left">ex.stringdb.edges (stringdb_edges)</td>
<td align="left">STRINGdb Edges example</td>
</tr>
<tr class="even">
<td align="left">ex_adj_consensus</td>
<td align="left">Adj Consensus</td>
</tr>
<tr class="odd">
<td align="left">ex_full_ptm_table</td>
<td align="left">Full PTM Table Example</td>
</tr>
<tr class="even">
<td align="left">ex_small_ptm_table</td>
<td align="left">Small PTM Table Example</td>
</tr>
<tr class="odd">
<td align="left">ex_tiny_ptm_table</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>If you are using the smaller dataset, use the following code to view
the dimensions of the dataset and a small portion of it:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">dim</span>(ex_small_ptm_table)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>ex_small_ptm_table[<span class="dv">38</span><span class="sc">:</span><span class="dv">50</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="dv">908</span>  <span class="dv">18</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span>                            H3122SEPTM_pTyr.C1 H3122SEPTM_pTyr.C2</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> HNRNPA3 p S358                             <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> EPHB4 p S575                               <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> BCAR1 p S407                           <span class="dv">163730</span>             <span class="dv">159600</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> MAGOH p S38; MAGOHB p S40             <span class="dv">1824100</span>                 <span class="cn">NA</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> DYNLL1 p S64; DYNLL2 p S64                 <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> PRKCD p S304                               <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> PCDH1 p S1018                              <span class="cn">NA</span>             <span class="dv">563220</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> AHNAK p S5832                              <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> AHNAK p S5841                              <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ARHGEF5 p S1139                            <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> SRSF9 p S178                               <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> RIPK1 p S389                               <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> URB2 p S18                                 <span class="cn">NA</span>                 <span class="cn">NA</span></span></code></pre></div>
<p>If you want to use the bigger dataset, the following code shows the
dimensions and a snippet of the dataset:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">dim</span>(ex_full_ptm_table)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>ex_full_ptm_table[<span class="dv">38</span><span class="sc">:</span><span class="dv">50</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="dv">9215</span>   <span class="dv">69</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span>                                H3122SEPTM.C1 H3122SEPTM.C2</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCC4 ubi K540                      <span class="fl">20.03456</span>            <span class="cn">NA</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCC4 ubi K622                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCC4 ubi K695                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCC4 ubi K77                             <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCC5 p Y10                               <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCD1 ubi K407; ABCD2 ubi K411            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCD3 ack K260                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCD3 ubi K260                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCD3 ubi K576                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCE1 ubi K121                      <span class="fl">17.62671</span>      <span class="fl">17.65533</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCE1 ubi K210                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCE1 ubi K250                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCE1 ubi K93                             <span class="cn">NA</span>            <span class="cn">NA</span></span></code></pre></div>
<p>If you have downloaded the larger dataset locally, you can read it
into R using the following code:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allptmtable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"AlldataPTMs.txt"</span>, sep <span class="op">=</span> <span class="st">"\t"</span>, skip <span class="op">=</span> <span class="fl">0</span>, header <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          blank.lines.skip <span class="op">=</span> <span class="cn">T</span>, fill <span class="op">=</span> <span class="cn">T</span>, quote <span class="op">=</span> <span class="st">"\""</span>, dec <span class="op">=</span> <span class="st">"."</span>,</span>
<span>                          comment.char <span class="op">=</span> <span class="st">""</span>, stringsAsFactors <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="using-your-own-data">Using Your Own Data<a class="anchor" aria-label="anchor" href="#using-your-own-data"></a>
</h3>
<p>To use your own MS data, you will need to transform it into a
dataframe with PTMs and row names, experimental conditions as column
names, and numeric data as the entries. Please refer to the <a href="RawDataProcessing.html">Raw Data Processing vignette</a> for a
tutorial showing all steps needed to transform an MS output file into a
P2P package input dataframe.</p>
</div>
</div>
<div class="section level2">
<h2 id="step-1-make-cluster-list">Step 1: Make Cluster List<a class="anchor" aria-label="anchor" href="#step-1-make-cluster-list"></a>
</h2>
<p><code>MakeClusterList</code> is the first step in the P2P process.
This function takes the dataframe <code>ptmtable</code> and runs it
through three calculations of statistical measures of distance:
Euclidean Distance, Spearman Dissimilarity (1- |Spearman Correlation|),
and SED (the average of both Spearman Dissimilarity (1- Spearman
Correlation) and Euclidean Distance). Combining the two dissimilarities
leads to better resolution of the data and is useful in pattern
recognition. A correlation table— <code>ptm.correlation.matrix</code>—is
generated based on the distances calculated for each pair of PTMs. The
function then runs the matrices through t-SNE to generate clusters based
on the previously calculated distance and provides you with a cluster
list, <code>common.clusters</code>. The returned
<code>adj.consensus.matrix</code> (which identifies which PTMs cluster
together with a ‘short distance’ between them) and
<code>ptm.correlation.matrix</code> are also used in the next step to
create co-cluster correlation networks (CCCNs). These three outputs are
returned as a list.</p>
<p>The <code>keeplength</code> paramter defines the minimum number of
PTMs that must be in a cluster for it to be retained in the final
output. The <code>toolong</code> parameter defines the maximum distance
between two PTMs for them to be considered as clustering together.</p>
<p><code>MakeClusterList</code> can be run like so:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">88</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>clusterlist.data <span class="ot">&lt;-</span> <span class="fu">MakeClusterList</span>(ex_small_ptm_table, <span class="at">keeplength =</span> <span class="dv">2</span>, <span class="at">toolong =</span> <span class="fl">3.5</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Starting correlation calculations and t<span class="sc">-</span>SNE.</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> This may take a few minutes or hours <span class="cf">for</span> large data sets.</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Spearman correlation calculation complete after <span class="fl">13.23</span> secs total.</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Spearman t<span class="sc">-</span>SNE calculation complete after <span class="fl">42.27</span> secs total.</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Euclidean distance calculation complete after <span class="fl">42.31</span> secs total.</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Euclidean t<span class="sc">-</span>SNE calculation complete after <span class="fl">1.15</span> mins total.</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Combined distance calculation complete after <span class="fl">1.15</span> mins total.</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> SED t<span class="sc">-</span>SNE calculation complete after <span class="fl">1.61</span> mins total.</span></code></pre></div>
<p><img src="plots/unnamed-chunk-9-1.png" class="r-plt" width="100%" style="display: block; margin: auto;"></p>
<pre><code>&gt;&gt; Clustering for Euclidean complete after 1.62 mins total.</code></pre>
<p><img src="plots/unnamed-chunk-9-2.png" class="r-plt" width="100%" style="display: block; margin: auto;"></p>
<pre><code>&gt;&gt; Clustering for Spearman complete after 1.63 mins total.</code></pre>
<p><img src="plots/unnamed-chunk-9-3.png" class="r-plt" width="100%" style="display: block; margin: auto;"></p>
<pre><code>&gt;&gt; Clustering for SED complete after 1.63 mins total.
&gt;&gt; Consensus clustering complete after 1.64 mins total.
&gt;&gt; MakeClusterList complete after 1.64 mins total.</code></pre>
<p>The following unpacks the output into the separate objects discussed
above:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">common.clusters</span> <span class="op">&lt;-</span> <span class="va">clusterlist.data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">adj.consensus.matrix</span> <span class="op">&lt;-</span> <span class="va">clusterlist.data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">ptm.correlation.matrix</span> <span class="op">&lt;-</span> <span class="va">clusterlist.data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Now we can view the objects. First, here is an example of a
cluster:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>common.clusters[<span class="dv">1</span>]</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="er">$</span>ConsensusCluster1</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="st">"KRT7 p S37"</span>                              </span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">2</span>] <span class="st">"CALM3 p Y100; CALM2 p Y100; CALM1 p Y100"</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">3</span>] <span class="st">"ERP29 p Y66"</span>                             </span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">4</span>] <span class="st">"MYH9 p Y1408"</span>                            </span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">5</span>] <span class="st">"PTK2 p Y925"</span>                             </span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">6</span>] <span class="st">"TNK2 p Y827"</span>                             </span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">7</span>] <span class="st">"ITSN2 p Y553"</span>                            </span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">8</span>] <span class="st">"PRRC2C p Y1218"</span></span></code></pre></div>
<p>Next, we look at a piece of the adjacency matrix. Ones represent a
pair that cluster and zeroes represent a pair that doesn’t:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>adj.consensus.matrix[<span class="dv">7</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span>               CTNND1 p S225 CTNND1 p S230 STAM2 p S375 EGFR p S1166</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> CTNND1 p S225             <span class="dv">0</span>             <span class="dv">0</span>            <span class="dv">0</span>            <span class="dv">0</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> CTNND1 p S230             <span class="dv">0</span>             <span class="dv">0</span>            <span class="dv">0</span>            <span class="dv">0</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> STAM2 p S375              <span class="dv">0</span>             <span class="dv">0</span>            <span class="dv">0</span>            <span class="dv">0</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> EGFR p S1166              <span class="dv">0</span>             <span class="dv">0</span>            <span class="dv">0</span>            <span class="dv">0</span></span></code></pre></div>
<p>Here is a part of the PTM correlation matrix. Values for pairs of
PTMs are Spearman correlation coefficients ranging from -1 to 1. If two
PTMs had no experimental conditions in common, their correlation value
will be NA.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>ptm.correlation.matrix[<span class="dv">38</span><span class="sc">:</span><span class="dv">43</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span>                            KRT7 p S37 KRT7 p S38</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> HNRNPA3 p S358                     <span class="cn">NA</span>         <span class="cn">NA</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> EPHB4 p S575                       <span class="cn">NA</span>         <span class="cn">NA</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> BCAR1 p S407                <span class="fl">0.5868132</span>        <span class="fl">0.5</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> MAGOH p S38; MAGOHB p S40   <span class="fl">1.0000000</span>         <span class="cn">NA</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> DYNLL1 p S64; DYNLL2 p S64 <span class="sc">-</span><span class="fl">0.8000000</span>         <span class="cn">NA</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> PRKCD p S304                <span class="fl">0.8571429</span>         <span class="cn">NA</span></span></code></pre></div>
<div class="section level5">
<h5 id="estimated-run-time-for-large-dataset">Estimated run-time (for large dataset)<a class="anchor" aria-label="anchor" href="#estimated-run-time-for-large-dataset"></a>
</h5>
<p>~60min</p>
</div>
</div>
<div class="section level2">
<h2 id="step-2-make-co-cluster-correlation-networks-ptm-and-gene">Step 2: Make Co-Cluster Correlation Networks (PTM and Gene)<a class="anchor" aria-label="anchor" href="#step-2-make-co-cluster-correlation-networks-ptm-and-gene"></a>
</h2>
<p>The data generated in the previous step is next used to create a new
network of PTMs that have strong associations called the Co-cluster
Correlation Network (CCCN). The Spearman correlations between
co-clustered PTMs are used as edge-weights in this network. The
MakeCorrelationNetwork function groups the PTM correlation matrices by
PTMs that co-cluster together to create a PTM CCCN. It then defines a
relationship between proteins modified by PTMs and creates a gene CCCN
with sum of the PTM correlations serving as edge weights.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>CCCN.data <span class="ot">&lt;-</span> <span class="fu">MakeCorrelationNetwork</span>(adj.consensus.matrix, ptm.correlation.matrix)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Making PTM CCCN</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> PTM CCCN complete after <span class="fl">0.16</span> secs total.</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Making Gene CCCN</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Gene CCCN complete after <span class="fl">1.9</span> secs total.</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>ptm.cccn.edges <span class="ot">&lt;-</span> CCCN.data[[<span class="dv">1</span>]]</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>gene.cccn.edges <span class="ot">&lt;-</span> CCCN.data[[<span class="dv">2</span>]]</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>gene.cccn.nodes <span class="ot">&lt;-</span> CCCN.data[[<span class="dv">3</span>]]</span></code></pre></div>
<p>We can view a portion of the PTM CCCN edges:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>ptm.cccn.edges[<span class="dv">18</span><span class="sc">:</span><span class="dv">22</span>,]</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span>           source        target     Weight          interaction</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">18</span> EIF2B1 p S131   PKP4 p S273 <span class="sc">-</span><span class="fl">0.6833333</span> negative correlation</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">19</span>   LDHB p S238   EML4 p S242 <span class="sc">-</span><span class="fl">1.0000000</span> negative correlation</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">20</span> S100A16 p S27   EML4 p S242 <span class="sc">-</span><span class="fl">0.5000000</span> negative correlation</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">21</span>     PXN p S90 S100A14 p S33 <span class="sc">-</span><span class="fl">0.3571429</span>          correlation</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">22</span>    URB2 p S18 SHANK2 p S589  <span class="fl">0.5428571</span> positive correlation</span></code></pre></div>
<p>And a portion of the gene CCCN edges:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>gene.cccn.edges[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span>   source target     Weight          interaction</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">1</span> ADGRL2  ALDOA <span class="sc">-</span><span class="fl">0.4535714</span>          correlation</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">2</span>   ACP1    ALK  <span class="fl">0.6000000</span> positive correlation</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">3</span>  AHNAK   ANO1  <span class="fl">1.5428571</span> positive correlation</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">4</span>   ACP1  ANXA2 <span class="sc">-</span><span class="fl">0.2571429</span>          correlation</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">5</span> ADAM10  ANXA2  <span class="fl">0.1702786</span>          correlation</span></code></pre></div>
<p>Finally, we can view a portion of the gene CCCN nodes, which are used
to map to external PPI databases in the next step:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>gene.cccn.nodes[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="st">"ADGRL2"</span> <span class="st">"ACP1"</span>   <span class="st">"AHNAK"</span>  <span class="st">"ADAM10"</span> <span class="st">"ALDOA"</span></span></code></pre></div>
<p>Because this step can take a long time to run on larger datasets, the
output may be saved as an RData object for later use.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save.image</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"filepath/name.RData"</span><span class="op">)</span> <span class="co"># All objects in the environment are saved</span></span></code></pre></div>
<div class="section level5">
<h5 id="estimated-run-time-for-large-dataset-1">Estimated run-time (for large dataset)<a class="anchor" aria-label="anchor" href="#estimated-run-time-for-large-dataset-1"></a>
</h5>
<p>~10min</p>
</div>
</div>
<div class="section level2">
<h2 id="step-3-retrieve-database-edgefiles">Step 3: Retrieve Database Edgefiles<a class="anchor" aria-label="anchor" href="#step-3-retrieve-database-edgefiles"></a>
</h2>
<p>The third step of the P2P package is to gather data from multiple
existing protein-protein interaction (PPI) databases which will be
integrated with the data generated in steps 1 and 2. The P2P package
explicitly allows the users to integrate data from three external
databases: STRING, GeneMANIA, and PhosphoSite Plus. Other databases can
also be downloaded and added to the PPI network. All three external
databases have different interfaces for downloading data, so we show how
to retrieve data from each of them below.</p>
<div class="section level4">
<h4 id="stringdb">1. STRINGdb<a class="anchor" aria-label="anchor" href="#stringdb"></a>
</h4>
<p><a href="https://string-db.org/" class="external-link">STRINGdb</a> can be queried directly
from R using the <code>STRINGdb</code> package. We wrap this query in a
function called <code>GetSTRINGdb</code>, which queries only for the
genes found in clusters in previous steps, and filters the returned by
interaction type so only <code>experimental</code>,
<code>database</code>, <code>experimental_transferred</code>, and
<code>database_transferred</code> are retained. This ensures that only
interactions with more substantial evidence are used in this
analysis.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>stringdb.edges <span class="ot">&lt;-</span> <span class="fu">GetSTRINGdb</span>(gene.cccn.edges, gene.cccn.nodes)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>stringdb.edges[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Warning<span class="sc">:</span>  we couldn<span class="st">'t map to STRING 0% of your identifiers   source target              interaction Weight</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="st">&gt;&gt; 21 MAPK13 MAPK12                 database   1128</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="st">&gt;&gt; 31 MAPK12  MAPK1                 database   1182</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="st">&gt;&gt; 35 GPRC5A   MYH9             experimental    164</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="st">&gt;&gt; 41   MISP   MYH9             experimental    148</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="st">&gt;&gt; 71   MYH9 PIK3R2 experimental_transferred    216</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="genemania">2. GeneMANIA<a class="anchor" aria-label="anchor" href="#genemania"></a>
</h4>
<p>To our knowledge, no R package exists to programmatically query <a href="https://genemania.org/" class="external-link">GeneMANIA</a>. Thus, we recommend using
the GeneMANIA Cytoscape App to retrieve PPI data as follows.</p>
<p>First, create an input file for GeneMANIA using the
<code>MakeDBInput</code> function provided within P2P (note that this
creates a text file in your working directory):</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MakeDBInput.html">MakeDBInput</a></span><span class="op">(</span><span class="va">gene.cccn.nodes</span>, file.path.name <span class="op">=</span> <span class="st">"db_nodes.txt"</span><span class="op">)</span></span></code></pre></div>
<p>Next, ensure that you have <a href="https://cytoscape.org/download.html" class="external-link">Cystoscape</a> and the <a href="https://apps.cytoscape.org/apps/genemania" class="external-link">GeneMANIA extension</a>
installed.</p>
<p>Copy the contents of the <code>db_nodes.txt</code> file into the
GeneMANIA App’s “Genes of Interest” box and run query.</p>
<p>To save the results, click on the three lines in the upper right
corner. This should be under the GeneMANIA side window beside the
species. Click “Export Results”. The path to this file is the
gm.results.path:</p>
<p><img src="vig_figs/GeneMANIA-image-1.png"><br><img src="vig_figs/GeneMANIA-image-2.png"></p>
<p>The <code>GetGeneMANIA.edges</code> function then processes the
output file produced by GeneMANIA itself. For example, we have saved
<code>ex_gm_results.txt</code> as an example output file from GeneMANIA
within the package. The following code shows how to use this file as
input to the function.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gm.results.path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ex_gm_results.txt"</span>, package <span class="op">=</span> <span class="st">"PTMsToPathways"</span><span class="op">)</span></span>
<span><span class="va">genemania.edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetGeneMANIA.edges.html">GetGeneMANIA.edges</a></span><span class="op">(</span><span class="va">gm.results.path</span>, <span class="va">gene.cccn.nodes</span><span class="op">)</span></span></code></pre></div>
<p>We can see an example of the GeneMANIA edges below:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>genemania.edges[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span>     source target           interaction      Weight</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">532</span>    LCK PTPN11               Pathway <span class="fl">0.001251833</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">533</span>    MET PTPN11               Pathway <span class="fl">0.001559102</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">547</span>   VAV1    LCK               Pathway <span class="fl">0.002001705</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">548</span>   VAV1 PTPN11               Pathway <span class="fl">0.001928108</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">549</span>    LCK  PTPRK Physical Interactions <span class="fl">0.253717814</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="phosphosite-plus">3. Phosphosite Plus<a class="anchor" aria-label="anchor" href="#phosphosite-plus"></a>
</h4>
<p>The kinase-substrate data can be downloaded from <a href="https://www.phosphosite.org/staticDownloads" class="external-link">Phosphosite Plus</a>
database. The users will be required to create an account and sign in to
download the data. The <code>formatKinsubTable</code> function reads
this downloaded data in and formats it so that all the PPI edge data
frames are in the same format for the next step.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input.filename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Kinase_Substrate_Dataset.txt"</span>, package <span class="op">=</span> <span class="st">"PTMsToPathways"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kinsub.edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formatKinsubTable.html">formatKinsubTable</a></span><span class="op">(</span><span class="va">input.filename</span>,</span>
<span>                                  <span class="va">gene.cccn.nodes</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="step-4-build-ppi-network-and-cluster-filtered-network">Step 4: Build PPI Network and Cluster Filtered Network<a class="anchor" aria-label="anchor" href="#step-4-build-ppi-network-and-cluster-filtered-network"></a>
</h2>
<p>The <code>BuildClusterFilteredNetwork</code> function allows the
users to filter protein-protein interaction networks using the
previously generated co-cluster correlation networks. PPIs are retained
in the cluster filtered network (CFN) only if the interacting proteins
share statistically correlated PTMs identified via t-SNE clusters. The
<code>BuildClusterFilteredNetwork</code> function combines all the PPI
data downloaded in step 3 as efficiently as possible while retaining the
desired edge weights. It then normalizes the weights on a scale of 0-1
and gives an output cluster filter network that will only retain
interacting proteins whose genes are within the co-cluster correlation
network created in step 2.</p>
<p>We first run the function:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">network.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BuildClusterFilteredNetwork.html">BuildClusterFilteredNetwork</a></span><span class="op">(</span><span class="va">gene.cccn.edges</span>, <span class="va">stringdb.edges</span>,</span>
<span>                                            <span class="va">genemania.edges</span>, kinsub.edges <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                            db.filepaths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>And then unpack the outputs into separate variables:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined.PPIs</span> <span class="op">&lt;-</span> <span class="va">network.list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">cfn</span> <span class="op">&lt;-</span> <span class="va">network.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>To reduce clutter on graphs, the CFN edges can be merged:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cfn.merged</span> <span class="op">&lt;-</span> <span class="fu">mergeEdges</span><span class="op">(</span><span class="va">cfn</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-5-pathway-crosstalk-network">Step 5: Pathway Crosstalk Network<a class="anchor" aria-label="anchor" href="#step-5-pathway-crosstalk-network"></a>
</h2>
<p>The final step is the creation of the Pathway Crosstalk Network
(PCN). This step requires input of an external database from <a href="https://tripod.nih.gov/bioplanet/download/pathway.csv" class="external-link">NCATS
BioPlanet</a> that contains groups of genes (proteins) involved in
various cellular processes known as pathways.
<code>BuildPathwayCrosstalkNetwork</code> turns this data file into a
list of pathways and converts those pathways into a list of
pathway-pathway edges, each of which is assigned a Jaccard similarity
and a Cluster-Pathway Evidence score based on the common clusters found
in the gene co-cluster correlation network. Info about the
Cluster-Pathway Evidence score can be found <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010690" class="external-link">here</a>
For graphing in Cytoscape, the Cluster-Pathway Evidence and Jaccard
similarity edges are listed separately in the edgelist called
pathway.crosstalk.network.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bioplanet.file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pathway.csv"</span>, package <span class="op">=</span> <span class="st">"PTMsToPathways"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>PCN.data <span class="ot">&lt;-</span> <span class="fu">PathwayCrosstalkNetwork</span>(common.clusters, bioplanet.file,</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>                                    <span class="at">createfile =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>pathway.crosstalk.network <span class="ot">&lt;-</span> PCN.data[[<span class="dv">1</span>]]</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>PCNedgelist <span class="ot">&lt;-</span> PCN.data[[<span class="dv">2</span>]]</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>pathways.list <span class="ot">&lt;-</span> PCN.data[[<span class="dv">3</span>]]</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="st">"Making PCN"</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="st">"2025-12-02 18:40:52 UTC"</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="st">"2025-12-02 18:40:52 UTC"</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] Total time<span class="sc">:</span> <span class="fl">0.109464168548584</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="saving-data">Saving Data<a class="anchor" aria-label="anchor" href="#saving-data"></a>
</h2>
<p>If you want to save your data to a file, all data structures can
either be exported with the save function and loaded later or saved to a
csv file with the write.csv function.</p>
<p>To save one object:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">object</span>, filename <span class="op">=</span> <span class="st">"filepath/name.rda"</span><span class="op">)</span> <span class="co"># Saves object as an .rda</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"filepath/name.rda"</span><span class="op">)</span>                    <span class="co"># Loads object saved to a file</span></span></code></pre></div>
<p>For multiple objects: Note the objects are saved as an .RData rather
than an .rda</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">object1</span>, <span class="va">object2</span>, <span class="va">object.ect</span>, filename<span class="op">=</span><span class="st">"NewFile.RData"</span><span class="op">)</span></span></code></pre></div>
<p>To save one object as a csv:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">object</span>, file <span class="op">=</span> <span class="st">"filepath/name.csv"</span><span class="op">)</span> <span class="co"># Saves object as a .csv</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"filepath/name.csv"</span><span class="op">)</span>          <span class="co"># Loads object from .csv</span></span></code></pre></div>
<p>You may also save your entire Global Environment namespace using the
save.image function as shown below:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save.image</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"filepath/name.RData"</span><span class="op">)</span> <span class="co"># All objects in the environment are saved</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Grimes, Mikhail Ukrainetz, Grant Smith, Madison Moffett, Nagashree Avabhrath, Lucia Williams.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
