<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analyzing Pathways from PTMs: A Guide • PTMsToPathways</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing Pathways from PTMs: A Guide">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PTMsToPathways</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/PTMsToPathways.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/RawDataProcessing.html">Analyzing Pathways from PTMs: A Guide</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analyzing Pathways from PTMs: A Guide</h1>
                        <h4 data-toc-skip class="author">Nagashree
Avabhrath, Mikhail Ukrainetz, Madison Moffett, Grant Smith, Lucia
Williams, Mark Grimes</h4>
            
      

      <div class="d-none name"><code>PTMsToPathways.Rmd</code></div>
    </div>

    
    
<p>
 
</p>
<p>The PTMsToPathways package takes mass spectrometry data of
post-translational modifications under different experimental conditions
and implicates pathways that are involved. These pathways are generated
based on analysis of which ptms cluster together (based on the similar
reactiosn to the same environmental conditions) compared to how those
proteins are known to interact. This clustering information is also used
to find interactions between known, existing pathways.</p>
<p><strong>An important note about this package:</strong> The returned
outputs from the functions are data that may be saved in an RData object
so that the user may reload the data, which may take a while to
generate, and pick up where they left off later.</p>
<p>
 
</p>
<div class="section level2">
<h2 id="starting-data">Starting Data<a class="anchor" aria-label="anchor" href="#starting-data"></a>
</h2>
<p>This package provides an example data set using 497 ptms and 69
experimental conditions in the correct format for entry. Below is an
example selection of the input dataset:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu">PTMsToPathways</span><span class="fu">::</span><span class="va"><a href="../reference/ex.ptmtable.html">ex.ptmtable</a></span><span class="op">)</span></span>
<span><span class="fu">PTMsToPathways</span><span class="fu">::</span><span class="va"><a href="../reference/ex.ptmtable.html">ex.ptmtable</a></span><span class="op">[</span><span class="fl">38</span><span class="op">:</span><span class="fl">50</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 497  69</span></span>
<span><span class="co">#&gt;               H3122SEPTM.C1 H3122SEPTM.C2 H3122SEPTM.C3 H3122SEPTM.D1</span></span>
<span><span class="co">#&gt; CTTN ack K107      19.23272      19.85052      19.58630      21.23678</span></span>
<span><span class="co">#&gt; CTTN ack K124      17.50665      19.73125      19.12403      21.14083</span></span>
<span><span class="co">#&gt; CTTN ack K161            NA            NA            NA            NA</span></span>
<span><span class="co">#&gt; CTTN ack K171            NA            NA            NA            NA</span></span>
<span><span class="co">#&gt; CTTN ack K198      20.53742      20.89560      20.04847      21.37846</span></span>
<span><span class="co">#&gt; CTTN ack K235      20.62203      20.74460      21.06424      22.02580</span></span>
<span><span class="co">#&gt; CTTN ack K272            NA            NA            NA      21.44114</span></span>
<span><span class="co">#&gt; CTTN ack K309      21.52164      21.03127      21.14289      22.49696</span></span>
<span><span class="co">#&gt; CTTN ack K87       19.61967      20.63351      20.49436      22.14973</span></span>
<span><span class="co">#&gt; CTTN p S156        21.09816      23.48837      22.33529      23.80410</span></span>
<span><span class="co">#&gt; CTTN p S405              NA            NA            NA            NA</span></span>
<span><span class="co">#&gt; CTTN p S417              NA      18.22809      18.97026      17.71552</span></span>
<span><span class="co">#&gt; CTTN p S418              NA      18.22809      18.97026      17.71552</span></span></code></pre></div>
<p>Note that it is very important that the rownames are the names of
post-translational modifications. All of their respective columns are
the environmental conditions under which the post-translational
modifications occurred. NAs – which are importantly not zeroes –
represent condition-PTM combinations that were not studied. The numeric
values are data output by the mass spectrometer. Ambigious PTMs, cases
where a PTM could be any one of several PTMs, should also be separated
by semicolons. (e.g. “AARS ubi k747; AMBLIL p U123”).</p>
<p>
 
</p>
</div>
<div class="section level2">
<h2 id="pre-processing-data">Pre-Processing Data<a class="anchor" aria-label="anchor" href="#pre-processing-data"></a>
</h2>
<p>For data that does not conform to the above structure, the data must
be converted. The following provides a set of general functions that may
assist in this process.</p>
<div class="section level5">
<h5 id="importing-the-dataframe">Importing the Dataframe<a class="anchor" aria-label="anchor" href="#importing-the-dataframe"></a>
</h5>
<p>R supports many file types and can automatically convert them into a
data frame. For example, read.csv() will take a csv file and convert it
into a data frame. The csv file type is recommended for data
storage.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ptmtable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"Pathto/filename.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">ptmtable</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="turning-columns-of-ptms-into-rownames">Turning Columns of PTMs into Rownames<a class="anchor" aria-label="anchor" href="#turning-columns-of-ptms-into-rownames"></a>
</h5>
<p>If there is/are column(s) that contain parts of PTM names (e.g. the
first column may contain the protein, the second column may contain the
post-translational modification, and the third column may contain the
location), the following command concatenates those columns and converts
them into data frame. The vector “name.columns” is the indices of the
columns which contain names. For the example below, the strings in
columns 1, 2, and 3 will be concatenated in each row and then turned
into a rowname. It is also possible to have name.columns equal a vector
like c(2, 4, 6), which takes columns 2, 4, and 6.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">name.columns</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ptmtable</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">ptmtable</span><span class="op">[</span><span class="va">name.columns</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">paste</span>, collapse<span class="op">=</span><span class="st">" "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ptmtable</span> <span class="op">&lt;-</span> <span class="va">ptmtable</span><span class="op">[</span>,<span class="op">-</span><span class="va">name.columns</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="replacing-patterns">Replacing Patterns<a class="anchor" aria-label="anchor" href="#replacing-patterns"></a>
</h5>
<p>If the list of PTMs possesses symbols that are unnecessary such as
“AARS ~K ubi K747”, this command will remove all strings included in the
“patterns” vector from the rownames. Any pattern can be chosen so long
as the user ensures that any special character (such as $ or @) have a
“\\” in front of them.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">patterns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">" ~K"</span>, <span class="st">"zzzz"</span>, <span class="st">"/"</span>, <span class="st">"\\$"</span>, <span class="st">"\\@"</span><span class="op">)</span></span>
<span><span class="va">patterns</span> <span class="op">&lt;-</span> <span class="va">patterns</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">patterns</span><span class="op">)</span>, <span class="va">patterns</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ptmtable</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ptmtable</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="kw">for</span><span class="op">(</span><span class="va">p</span> <span class="kw">in</span> <span class="va">patterns</span><span class="op">)</span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="va">p</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>
 
</p>
</div>
</div>
<div class="section level2">
<h2 id="pipeline">Pipeline<a class="anchor" aria-label="anchor" href="#pipeline"></a>
</h2>
<p>The following pipeline is intended to be a step-by-step guide to walk
users through the process of using the PTMsToPathways package. It
includes descriptions of each function. This pipeline must be run in
order as subsequent steps require the data produced in previous steps.
Example code and example outputs as well as estimated run-times are
included with each description and are based on a preliminary dataset of
~9,000 post-translational modifications and 69 experimental conditions
processed with a 12th Gen i5 processor and 8GB of RAM.</p>
<p>
 
</p>
<div class="section level3">
<h3 id="step-1-make-cluster-list">Step 1: Make Cluster List<a class="anchor" aria-label="anchor" href="#step-1-make-cluster-list"></a>
</h3>
<p>Make Cluster List is the first step in the analyzing one’s data. This
function takes the post-translational modification table and runs it
through three calculations of distance: Euclidean Distance, Spearman
Dissimilarity (1 - |Spearman Correlation|), and the average of the two
of these. These calculations find the ‘distance’ between ptms based upon
under what conditions they occur. In other words, they found how
dissimilar each pair of PTMs are. These matricies are then run through
t-SNE in order to put them into a 3-dimensional space and the clusters
that are present in each present in each matrix are identified as well.
Please note: t-SNE involves an element of randomness due to pseudorandom
initialization or stochastic processes within the algorithm; in order to
get exactly the same results on multiple executions, set.seed(#) must be
called (# = any integer of choice). A correlation table is also produced
based on the Spearman Correlation values for each pair of PTMs.</p>
<div class="section level5">
<h5 id="code">Code<a class="anchor" aria-label="anchor" href="#code"></a>
</h5>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clusterlist.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MakeClusterList.html">MakeClusterList</a></span><span class="op">(</span><span class="va">ptmtable</span>, keeplength <span class="op">=</span> <span class="fl">2</span>, toolong <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span></span>
<span><span class="va">common.clusters</span> <span class="op">&lt;-</span> <span class="va">clusterlist.data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">adj.consensus</span> <span class="op">&lt;-</span> <span class="va">clusterlist.data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">ptm.correlation.matrix</span> <span class="op">&lt;-</span> <span class="va">clusterlist.data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<center>
<p><img src="vig_figs/EU_MCL.png"><br></p>
<p>
 
</p>
<p><strong>Figure 1</strong> Example plot produced by MakeClusterList
calculated using Euclidean Distance. The Euclidean Distance between
every PTM is calculated and that information is put into a large matrix.
This matrix is then condensed using t-SNE to get coordinates in
two-dimensional space, which is what the above figure shows. These data
points – and the PTMs they represent – are put into clusters based on
these positions. This process is also undergone using Spearman
Dissimilarity and the average of Euclidean Distance and Spearman
Dissimilarity.</p>
<p>
 
</p>
<p><img src="vig_figs/MCL-output.png"><br></p>
<p>
 
</p>
<p><strong>Figure 2</strong> Output of MakeClusterList. Automatic print
statements from the function ordiplot from the package vegan.</p>
<p>
 
</p>
<p><img src="vig_figs/EU_clusters.png"></p>
<p>
 
</p>
<p><strong>Figure 3</strong> The second cluster created by Euclidean
Distance. The left column is the name of the PTM in this cluster. The
right column is the cluster number.</p>
<p>
 
</p>
<p><img src="vig_figs/common_clusters.png"></p>
<p>
 
</p>
<p><strong>Figure 4</strong> The second common cluster. All six of these
post-translational modifications were clustered together whether
distance was calculated by Spearman, Euclidean, or the average.</p>
<p>
 
</p>
<p><img src="vig_figs/tsne_coords.png"></p>
<p>
 
</p>
<p><strong>Figure 5</strong> Coordinates of the t-SNE plot produced by
Spearman Dissimilarity. Each row is a ptm, and each column is its
positional location along the x, y, and z axes.</p>
</center>
<p>
 
</p>
</div>
<div class="section level5">
<h5 id="estimated-run-time">Estimated run-time<a class="anchor" aria-label="anchor" href="#estimated-run-time"></a>
</h5>
<p>2hrs 30mins</p>
<p>
 
</p>
</div>
</div>
<div class="section level3">
<h3 id="step-2-make-correlation-network">Step 2: Make Correlation Network<a class="anchor" aria-label="anchor" href="#step-2-make-correlation-network"></a>
</h3>
<p>Next, Make Correlation Network is run to filter the correlation
matrix of PTMs by specific PTMs that cluster together or have react
similarly to the same conditions. It groups the PTM correlation matrix
based on the Genes of PTMs. By summing these submatrices, it produces a
gene by gene cocluster correlation network shows strength of
relationships between proteins using the common clusters between the
three distance metrics. The PTM version is also saved for analysis by
the user.</p>
<div class="section level5">
<h5 id="code-1">Code<a class="anchor" aria-label="anchor" href="#code-1"></a>
</h5>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CCCN.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MakeCorrelationNetwork.html">MakeCorrelationNetwork</a></span><span class="op">(</span><span class="va">common.clusters</span>, <span class="va">ptm.correlation.matrix</span><span class="op">)</span></span>
<span><span class="va">ptm.cccn.g</span> <span class="op">&lt;-</span> <span class="va">CCCN.data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">gene.cccn.g</span> <span class="op">&lt;-</span> <span class="va">CCCN.data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">ptm.cccn.edges</span> <span class="op">&lt;-</span> <span class="va">CCCN.data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">gene.cccn.edges</span> <span class="op">&lt;-</span> <span class="va">CCCN.data</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<center>
<p><img src="vig_figs/ptm_cccn.png"></p>
<p>
 
</p>
<p><strong>Figure 6</strong> First 17 rows and columns of the ptm.cccn
produced by MakeCorrelationNetwork. PTMs that cluster together in all
three distance metrics have entries that represent how strongly they
correlate, or how alike their responses are under the same environment.
PTMs that don’t cluster in all three distance metrics are correlated by
an NA. Self-correlations are also marked by an NA to prevent
self-similarity skewing.</p>
<p>
 
</p>
<p><img src="vig_figs/gene_cccn.png"></p>
<p>
 
</p>
<p><strong>Figure 7</strong> First 17 rows and columns of the genes.cccn
produced by MakeCorrelationNetwork. The ptm.cccn was condensed by
combining all of the scores between PTMs corresponding to one gene.
These new summed scores make up the scores of the genes.ccn.
Self-correlations are marked by an NA to prevent self-similarity
skewing.</p>
</center>
</div>
<div class="section level5">
<h5 id="estimated-run-time-1">Estimated run-time<a class="anchor" aria-label="anchor" href="#estimated-run-time-1"></a>
</h5>
<p>12hrs</p>
<p>
 
</p>
</div>
</div>
<div class="section level3">
<h3 id="step-3-retrieve-database-edgefiles">Step 3: Retrieve Database Edgefiles<a class="anchor" aria-label="anchor" href="#step-3-retrieve-database-edgefiles"></a>
</h3>
<div class="section level4">
<h4 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h4>
<p>The third step of the PTMsToPathways pipeline is broken up into
several parts as there is a lot of choice for the user during each
sub-step. PPI (protein-protein interaction) databases are consulted in
order to filter the clusters by proteins that are known to interact with
each other as well as how strongly they are known to interact. The
standard recommended PPI database is STRINGdb; getting data from this
database is the first (optional) step. This is accomplished with the
function GetSTRINGdb. The function GetSTRINGdb requires the STRINGdb
package to be downloaded. Code for this is supplied with the code to run
the function itself. Please note, however, that the user may consult any
database that they choose. After getting STRINGdb data (or not), the
user runs MakeDBInput which produces a text file of all of their gene
names. This information can be copy and pasted into any database that
the user chooses in order to get data from other PPI networks. Step
three is getting a GeneMANIA network, which is also optional but
recommended. The user pastes their input data into GeneMANIA on the
Cytoscape app and saves the edgefile and the nodetable. These files are
then input into ProcessGMEdgefile in order to sort the data.</p>
<p>Note again that the database input can be used in any PPI database
that the user chooses, though this package only explicitly supports
STRINGdb and GeneMANIA. If another database is chosen, its file will
have to be filtered manually by the user before moving on to step 4. The
file should have four columns. Column one and two should strictly be
labeled “source” and “target” in order to integrate with other PPI
databases. Column three, “interaction”, should name the interaction type
between the two proteins (these have different names in different PPI
databases). The fourth column, “Weight”, should contain the edge weight
from the PPI databases. .</p>
<p>
 
</p>
</div>
<div class="section level4">
<h4 id="part-1-get-stringdb-data">Part 1 — Get STRINGdb Data<a class="anchor" aria-label="anchor" href="#part-1-get-stringdb-data"></a>
</h4>
<div class="section level5">
<h5 id="code-2">Code<a class="anchor" aria-label="anchor" href="#code-2"></a>
</h5>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/" class="external-link">"BiocManager"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"STRINGdb"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stringdb.edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetSTRINGdb.html">GetSTRINGdb</a></span><span class="op">(</span><span class="va">gene.cccn</span><span class="op">)</span></span></code></pre></div>
<center>
<p><img src="vig_figs/string_edges.png"><br></p>
<p>
 
</p>
<p><strong>Figure 8</strong> First 18 rows of stringdb.edges produced by
GetSTRINGdb. The first two columns represent the genes that are known to
interact. The second column is the type of interaction. The GetSTRINGdb
function limits the interaction types to database, database_transferred
(database information from other species’ that are homologous to
humans), experimental, and experimental_transferred (database
information from other species’ that are homologous to humans). The
final column is the score associated with this interaction.</p>
<p>
 
</p>
<p><img src="vig_figs/nodenames.png"><br></p>
<p>
 
</p>
<p><strong>Figure 9</strong> First 18 rows of nodenames produced by
GetSTRINGdb. Nodenames is a data frame consisting of every gene in
gene.cccn. This represents all of the genes of the study (that
cocluster).</p>
</center>
<p>
 
</p>
</div>
<div class="section level5">
<h5 id="estimated-run-time-2">Estimated run-time<a class="anchor" aria-label="anchor" href="#estimated-run-time-2"></a>
</h5>
<p>1hr</p>
<p>
 
</p>
</div>
</div>
<div class="section level4">
<h4 id="part-2-get-file-for-database-input">Part 2 — Get File for Database Input<a class="anchor" aria-label="anchor" href="#part-2-get-file-for-database-input"></a>
</h4>
<div class="section level5">
<h5 id="code-3">Code<a class="anchor" aria-label="anchor" href="#code-3"></a>
</h5>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MakeDBInput.html">MakeDBInput</a></span><span class="op">(</span><span class="va">gene.cccn</span>, file.path.name <span class="op">=</span> <span class="st">"db_nodes.txt"</span><span class="op">)</span></span></code></pre></div>
<center>
<p><img src="vig_figs/db_nodes-txt.png"></p>
<p>
 
</p>
<p><strong>Figure 10</strong> First 15 lines from the produced text file
named by file.path.name. Lists all of the gene names separated by
newlines with no other extra characters for clean copy and pasting into
a database input.</p>
</center>
<p>
 
</p>
</div>
<div class="section level5">
<h5 id="estimated-run-time-3">Estimated run-time<a class="anchor" aria-label="anchor" href="#estimated-run-time-3"></a>
</h5>
<p>0s</p>
<p>
 
</p>
</div>
</div>
<div class="section level4">
<h4 id="part-3-process-genemania-file-and-read-in-kinase-substrate-data-from-phosphositeplus-httpswww-phosphosite-orgstaticdownloads">Part 3 — Process GeneMANIA File and read in Kinase Substrate Data
from PhosphositePlus (<a href="https://www.phosphosite.org/staticDownloads" class="external-link uri">https://www.phosphosite.org/staticDownloads</a>)<a class="anchor" aria-label="anchor" href="#part-3-process-genemania-file-and-read-in-kinase-substrate-data-from-phosphositeplus-httpswww-phosphosite-orgstaticdownloads"></a>
</h4>
<div class="section level5">
<h5 id="code-4">Code<a class="anchor" aria-label="anchor" href="#code-4"></a>
</h5>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genemania.edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ProcessGMEdgefile.html">ProcessGMEdgefile</a></span><span class="op">(</span><span class="va">gm.edgefile.path</span>, <span class="va">gm.nodetable.path</span>, <span class="va">db_nodes.path</span><span class="op">)</span></span>
<span><span class="va">kinsub.edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format.kinsub.table.html">format.kinsub.table</a></span><span class="op">(</span>kinasesubstrate.filename <span class="op">=</span> <span class="st">"Kinase_Substrate_Dataset.txt"</span><span class="op">)</span></span></code></pre></div>
<center>
<p><img src="vig_figs/gm_nodetable.png"></p>
<p>
 
</p>
<p><strong>Figure 11</strong> The node table produced by the GeneMANIA
query.</p>
<p>
 
</p>
<p><img src="vig_figs/gm_edgetable.png"></p>
<p>
 
</p>
<p><strong>Figure 12</strong> The edge table produced by the GeneMANIA
query.</p>
<p>
 
</p>
<p><img src="vig_figs/gm_network.png"></p>
<p>
 
</p>
<p><strong>Figure 13</strong> First 44 rows of the GeneMANIA network.
The first two columns represent the genes that are known to interact.
The second column is the type of interaction. The ProcessGmEdgefile
function limits the interaction types to Pathway and Physical
Interactions. The final column is the score associated with this
interaction.</p>
</center>
<p>
 
</p>
</div>
<div class="section level5">
<h5 id="estimated-run-time-4">Estimated run-time<a class="anchor" aria-label="anchor" href="#estimated-run-time-4"></a>
</h5>
<p>10s</p>
<p>
 
</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="step-4-build-ppi-network">Step 4: Build PPI Network<a class="anchor" aria-label="anchor" href="#step-4-build-ppi-network"></a>
</h3>
<p>The fourth step in the pipeline, BuildClusterFilteredNetwork,
combines the data of protein-protein interactions from each of the
provided databases. This package explicitly processes STRINGdb and
GeneMANIA in Step 3, but the user may consult as many databases as
desired (the processing for which is described in Step 3).
BuildClusterFilteredNetwork combines these databases as efficiently as
possible while retaining desired edgeweights from each database.
BuildClusterFilteredNetwork also normalizes the weights on a scale of
0-1 and removes duplicate rows from the data frame. The Cluster Filtered
Network, one of the final outputs of the package, checks all of the
edges in the PPI network to ensure that both of the genes are within the
cocluster correlation network created in step two and that its weight is
nonzero. If either of these conditions are not met, then it will be
removed from the list of PPI edges. This new, cluster filtered network
is then returned. The combined PPIs are all the PPIs for all genes in
the data. The cfn is about 12% of these filtered by PTM cluster
data.</p>
<div class="section level5">
<h5 id="code-5">Code<a class="anchor" aria-label="anchor" href="#code-5"></a>
</h5>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">network.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BuildClusterFilteredNetwork.html">BuildClusterFilteredNetwork</a></span><span class="op">(</span><span class="va">stringdb.edges</span>, <span class="va">genemania.edges</span>, <span class="va">kinsub.edges</span>, <span class="va">gene.cccn.edges</span>, db.filepaths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">combined.PPIs</span> <span class="op">&lt;-</span> <span class="va">network.list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">cfn</span> <span class="op">&lt;-</span> <span class="va">network.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co"># To reduce clutter on graphs, the cfn edges can be merged:</span></span>
<span><span class="va">cfn.merged</span> <span class="op">&lt;-</span> <span class="fu">mergeEdges</span><span class="op">(</span><span class="va">cfn</span><span class="op">)</span></span></code></pre></div>
<center>
<p><img src="vig_figs/ppi_network.png"><br></p>
<p>
 
</p>
<p><strong>Figure 14</strong> First 19 rows of the ppi_network produced
by find_ppi_edges. The first two columns represent the two genes that
interact according to the consulted PPI databases. The third column is
all of the interaction types concatenated together from each database.
All subsequent columns (two, in the base case of just using STRINGdb and
GeneMANIA), show the weights of the interaction from the associated
database. These have been normalized to all be on a scale of 0-1.</p>
</center>
<p>
 
</p>
</div>
<div class="section level5">
<h5 id="estimated-run-time-5">Estimated run-time<a class="anchor" aria-label="anchor" href="#estimated-run-time-5"></a>
</h5>
<p>1hr (only using STRINGdb and GeneMANIA)</p>
<p>
 
</p>
<center>
<p><img src="vig_figs/cfn.png"><br></p>
<p>
 
</p>
<p><strong>Figure 15</strong> First 19 rows of the cfn produced by
ClusterFilteredNetwork. The first two columns represent the two genes
that interact according to the consulted PPI databases. The third column
is all of the interaction types concatenated together from each
database. The final column is the sum of the weights from each inputted
database.</p>
</center>
<p>
 
</p>
</div>
<div class="section level5">
<h5 id="estimated-run-time-6">Estimated run-time<a class="anchor" aria-label="anchor" href="#estimated-run-time-6"></a>
</h5>
<p>10mins</p>
<p>
 
</p>
</div>
</div>
<div class="section level3">
<h3 id="step-6-pathway-crosstalk-network">Step 6: Pathway Crosstalk Network<a class="anchor" aria-label="anchor" href="#step-6-pathway-crosstalk-network"></a>
</h3>
<p><strong>Note:</strong> This step is directory sensitive. The user can
check and set the working directory in R using getwd() and
setwd(“yourdirectoryhere”) respectively. It needs a path to the
bioplanet file and will put an edgelist file in the working directory or
the otherwise given path. If the file cannot be found, please check the
working directory first.</p>
<p>Step 6, our final analysis step, is the Pathway Crosstalk Network.
This step requires input of an external database, bioplanet, that
contains groups of genes (proteins) involved in various cellular
processes known as pathways. PCN turns this database into a list of
pathways and converts those pathways into a pathway x pathway edgelist
(PCNedgelist) that possesses multiple weights, a jaccard similarity, and
a score. The score is derived from Cluster-Pathway Evidence using the
common clusters found in Make Correlation Network. Info about the
Cluster-Pathway Evidence score can be found at: <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010690" class="external-link uri">https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010690</a>.
For graphing in Cytoscape, the Cluster-Pathway Evidence and Jaccard
similarity edges are listed separately in the edgelist called
pathway.crosstalk.network.</p>
<div class="section level5">
<h5 id="code-6">Code<a class="anchor" aria-label="anchor" href="#code-6"></a>
</h5>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PCN.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PathwayCrosstalkNetwork.html">PathwayCrosstalkNetwork</a></span><span class="op">(</span><span class="va">common.clusters</span>, bioplanet.file <span class="op">=</span> <span class="st">"bioplanet.csv"</span>, createfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pathway.crosstalk.network</span> <span class="op">&lt;-</span> <span class="va">PCN.data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">PCNedgelist</span> <span class="op">&lt;-</span> <span class="va">PCN.data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">pathways.list</span> <span class="op">&lt;-</span> <span class="va">PCN.data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<center>
<p><img src="vig_figs/PTP_edgelist.png"></p>
<p>
 
</p>
<p><strong>Figure 16</strong> The Pathway To Pathway Edgelist created by
Pathway Crosstalk Network. This table shows the relationships between
each pair of pathways represented in Bioplanet and the dataset as well
as two different scores for the strength of the interaction.</p>
</center>
<p>
 
</p>
</div>
<div class="section level5">
<h5 id="estimated-run-time-7">Estimated run-time<a class="anchor" aria-label="anchor" href="#estimated-run-time-7"></a>
</h5>
<p>UNKNOWN</p>
<p>
 
</p>
</div>
</div>
<div class="section level3">
<h3 id="step-7-graph-networks-in-cytoscape">Step 7: Graph Networks in Cytoscape<a class="anchor" aria-label="anchor" href="#step-7-graph-networks-in-cytoscape"></a>
</h3>
<p>It is possible to graph the entire PCN, CFN, and CCCNs in their
entirety, though very large graphs take a long time to graph. One
approach to navigating these data structures is to select nodes from the
large networks in Cytoscape (or in R using RCy3::selectNodes()) and
select nearest neighbors or shortest paths and create a subnetwork in a
new window (see the Cytoscape Manual <a href="https://manual.cytoscape.org/en/stable/" class="external-link uri">https://manual.cytoscape.org/en/stable/</a>).</p>
<p>The approach described below is to identify pathways, genes, and PTMs
of interest in the R data objects, then make smaller, more interpretable
graphs in Cytoscape using RCy3.</p>
<p>For example, we will find names of all pathways in Bioplanet that
contain EGFR. The data object ‘pathways.list’ is a list, where the name
of the list element is the name of a Bioplanet pathway and each element
is a character vector of the genes in that pathway. Then we want to find
interactions between the pathway “Transmembrane transport of small
molecules” and those pathways. The utility functions used below are in
CytoscapeGraphing.R</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">egfr_pathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pathways.list</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pathways.list</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="st">"EGFR"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">pathways.list</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">egfr_pathways</span><span class="op">)</span> <span class="co">#83</span></span>
<span><span class="va">egfr_transporter.pcn</span> <span class="op">&lt;-</span> <span class="fu">filter.edges.between</span><span class="op">(</span><span class="st">"Transmembrane transport of small molecules"</span>, <span class="va">egfr_pathways</span>, <span class="va">PCNedgelist</span><span class="op">)</span></span>
<span><span class="va">egfr_transporter_pcn.cy</span> <span class="op">&lt;-</span> <span class="fu">filter.edges.between</span><span class="op">(</span><span class="st">"Transmembrane transport of small molecules"</span>, <span class="va">egfr_pathways</span>, <span class="va">pathway.crosstalk.network</span><span class="op">)</span></span></code></pre></div>
<p>These two versions of the PCN show cluster evidence and Jaccard
smilarity in adjacent columns (the first case) or as distinct edges (the
second case, which can be used to plot this network in cytoscape).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Graph PCN</span></span>
<span><span class="va">pcn.graph.1</span> <span class="op">&lt;-</span> <span class="fu">cytoscape.graph.PCN.pathways</span><span class="op">(</span>PCN <span class="op">=</span> <span class="va">egfr_transporter_pcn.cy</span>, net.name<span class="op">=</span><span class="st">"EGFR signaling and transmembrane transporters"</span>, Jaccard.edges<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<p>Let’s zero in on interactions between proteins in the two pathways
“EGF/EGFR signaling pathway” and “Transmembrane transport of small
molecules” because they have no genes in common. First we extract a
network of interactions between the genes in the two pathways. Then we
generate a node file for cytoscape. In the following case we include the
data extracted from the ptmtable. This is optional, useful if node size
and color is used later to indicate values in data.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">egfr_transporter.cfn</span> <span class="op">&lt;-</span> <span class="fu">filter.edges.between</span><span class="op">(</span><span class="va">pathways.list</span><span class="op">[[</span><span class="st">"EGF/EGFR signaling pathway"</span><span class="op">]</span><span class="op">]</span>, <span class="va">pathways.list</span><span class="op">[[</span><span class="st">"Transmembrane transport of small molecules"</span><span class="op">]</span><span class="op">]</span>, <span class="va">cfn</span><span class="op">)</span></span>
<span><span class="va">egfr_transporter.nodes</span> <span class="op">&lt;-</span> <span class="fu">make.cytoscape.node.file</span> <span class="op">(</span><span class="va">egfr_transporter.cfn</span>, <span class="va">funckey</span>, <span class="va">ptmtable</span>, include.gene.data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<p>The function GraphCfn creates a graph using the cluster filtered
network in the Cytoscape app. When graphed, Cytoscape provides an
interactive interface to view the data. This function requires the edge
list file (egfr_transporter.cfn in the example), and node data file
(egfr_transporter.nodes).</p>
<div class="section level5">
<h5 id="code-7">Code<a class="anchor" aria-label="anchor" href="#code-7"></a>
</h5>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">GraphCfn</span><span class="op">(</span>cfn.edges <span class="op">=</span> <span class="va">egfr_transporter.cfn</span>, cfn.nodes <span class="op">=</span> <span class="va">egfr_transporter.nodes</span>,  Network.title <span class="op">=</span> <span class="st">"CFN"</span>, Network.collection <span class="op">=</span> <span class="st">"PTMsToPathways"</span><span class="op">)</span></span>
<span><span class="co"># Choose a ratio data column to show which proteins' PTMs were inhibited by a drug</span></span>
<span><span class="fu">setNodeColorToRatios</span><span class="op">(</span>plotcol<span class="op">=</span><span class="st">"PC9_ErlotinibRatio"</span><span class="op">)</span></span></code></pre></div>
<center>
<p><img src="vig_figs/cytoscape_graph.png"><br></p>
<p>
 
</p>
<p><strong>Figure 17</strong> Default cytoscape graph. Nodes represent
the genes of the study. The score of each node is taken as the minimum
value of the gene in the ptmtable. Edges are the lines between the nodes
and they represent relationships. See the key below for a full
description of each characteristic.</p>
</center>
<p>
 
</p>
<p>Let’s now zoom in further on PTMs for a subset of proteins whose PTMs
were affected by the tyrosine kinase inhbitor.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">egfr_ATP1A1</span> <span class="op">&lt;-</span> <span class="fu">connectNodes.all</span><span class="op">(</span>nodepair <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EGFR"</span>, <span class="st">"ATP1A1"</span><span class="op">)</span>, ig.graph<span class="op">=</span><span class="cn">NULL</span>, edgefile<span class="op">=</span><span class="va">cfn</span>, newgraph<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># To include co-clustered PTMs in the network an extra step is necessary:</span></span>
<span><span class="va">egfr_ATP1A1_plus</span> <span class="op">&lt;-</span> <span class="fu">get.co.clustered.ptms</span><span class="op">(</span><span class="va">egfr_ATP1A1</span><span class="op">)</span></span>
<span><span class="va">egfr_ATP1A1.nodes</span> <span class="op">&lt;-</span> <span class="fu">make.cytoscape.node.file</span> <span class="op">(</span><span class="va">egfr_ATP1A1_plus</span>, <span class="va">funckey</span>, <span class="va">ptmtable</span>, include.gene.data <span class="op">=</span> <span class="cn">TRUE</span>, include.PTM.data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span> <span class="co"># Now, graph in cytoscape</span></span>
<span><span class="fu">GraphCfn</span><span class="op">(</span>cfn.edges <span class="op">=</span> <span class="va">egfr_ATP1A1_plus</span>, cfn.nodes <span class="op">=</span> <span class="va">egfr_ATP1A1.nodes</span>,  Network.title <span class="op">=</span> <span class="st">"CFN/CCCN"</span>, Network.collection <span class="op">=</span> <span class="st">"PTMsToPathways"</span><span class="op">)</span></span>
<span><span class="co"># Choose a ratio data column to show which proteins' PTMs were inhibited by a drug</span></span>
<span><span class="fu">setNodeColorToRatios</span><span class="op">(</span>plotcol<span class="op">=</span><span class="st">"PC9_ErlotinibRatio"</span><span class="op">)</span></span>
<span><span class="co"># Note that within Cytoscape you can change the column for node size and color (two separate tings) in the "Styles" tab</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="dasatinib---focal-adhesion">Dasatinib - focal adhesion<a class="anchor" aria-label="anchor" href="#dasatinib---focal-adhesion"></a>
</h5>
<p>Dasatinib exhibits strong binding and inhibitory effects on multiple
focal adhesion-associated genes from your provided BioPlanet list: • SRC
(proto-oncogene tyrosine-protein kinase Src) • FYN (tyrosine-protein
kinase Fyn) • EGFR (epidermal growth factor receptor) • ERBB2 (receptor
tyrosine-protein kinase erbB-2) All these genes are directly implicated
in focal adhesion signaling regulation. We hypothesize that ptms on
proteins involved in focal adhesion will be downregulated by
dasatinib.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pt.sub</span> <span class="op">&lt;-</span> <span class="va">ptmtable</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"DasatinibRatio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span> <span class="op">(</span><span class="va">ptmtable</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">pt.sub</span><span class="op">$</span><span class="va">Sum.Dasat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">pt.sub</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pt.sub</span> <span class="op">&lt;-</span> <span class="va">pt.sub</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">pt.sub</span><span class="op">$</span><span class="va">Sum.Dasat</span>, decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">pt.sub</span><span class="op">$</span><span class="va">Gene.Name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">pt.sub</span><span class="op">)</span>,  <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">" "</span>,  fixed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fa.genes</span> <span class="op">&lt;-</span> <span class="va">pathways.list</span><span class="op">[[</span><span class="st">"Focal adhesion"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">pt.sub.fa</span> <span class="op">&lt;-</span> <span class="va">pt.sub</span><span class="op">[</span><span class="va">pt.sub</span><span class="op">$</span><span class="va">Gene.Name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">fa.genes</span>,<span class="op">]</span></span>
<span><span class="va">pt.sub.fa.topz</span> <span class="op">&lt;-</span> <span class="va">pt.sub.fa</span><span class="op">[</span><span class="va">pt.sub.fa</span><span class="op">$</span><span class="va">Sum.Dasat</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">2</span>,<span class="op">]</span></span>
<span><span class="va">ptms</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">pt.sub.fa.topz</span><span class="op">)</span></span>
<span><span class="co"># Employ a helper function to derive a cfn starting with a list of PTMs</span></span>
<span><span class="va">cfn.cccn</span> <span class="op">&lt;-</span> <span class="fu">ptms_to_cfn</span><span class="op">(</span><span class="va">ptms</span>, cfn <span class="op">=</span> <span class="va">cfn.merged</span>, pepsep <span class="op">=</span> <span class="st">";"</span><span class="op">)</span></span>
<span><span class="va">cfn_cccn.nodes</span> <span class="op">&lt;-</span> <span class="fu">make.cytoscape.node.file</span><span class="op">(</span><span class="va">cfn.cccn</span>, <span class="va">funckey</span>, <span class="va">ptmtable</span>, include.gene.data <span class="op">=</span> <span class="cn">TRUE</span>, include.coclustered.PTMs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Let's see what it looks like.</span></span>
<span><span class="fu">GraphCfn</span><span class="op">(</span>cfn.edges <span class="op">=</span> <span class="va">cfn.cccn</span>, cfn.nodes <span class="op">=</span> <span class="va">cfn_cccn.nodes</span>,  Network.title <span class="op">=</span> <span class="st">"CFN/CCCN"</span>, Network.collection <span class="op">=</span> <span class="st">"PTMsToPathways"</span><span class="op">)</span></span>
<span><span class="co"># Choose a ratio data column to show which proteins' PTMs were inhibited by a dasatinib</span></span>
<span><span class="fu">setNodeColorToRatios</span><span class="op">(</span>plotcol<span class="op">=</span><span class="st">"H366_DasatinibRatio"</span><span class="op">)</span></span>
<span><span class="fu">setNodeColorToRatios</span><span class="op">(</span>plotcol<span class="op">=</span><span class="st">"H2286_DasatinibRatio"</span><span class="op">)</span></span>
<span><span class="co"># Note that within Cytoscape you can change the column for node size and color (two separate tings) in the "Styles" tab</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="key">Key<a class="anchor" aria-label="anchor" href="#key"></a>
</h5>
<p>The thicker the edge is, the stronger the interaction between these
two genes. The border and shape of the node represent the type of
protein this gene is.</p>
<p>Node Size:</p>
<ul>
<li>Greater the node size, larger the absolute value of the score</li>
</ul>
<p>Node Color:</p>
<ul>
<li>Blue Node
<ul>
<li>Negative score<br>
</li>
</ul>
</li>
<li>Yellow Node
<ul>
<li>Positive score<br>
</li>
</ul>
</li>
<li>Green Node
<ul>
<li>Approximately zero score</li>
</ul>
</li>
</ul>
<p>Node Shapes:</p>
<ul>
<li>“ELLIPSE”
<ul>
<li>unknown<br>
</li>
</ul>
</li>
<li>“ROUND_RECTANGLE”
<ul>
<li>receptor tyrosine kinase<br>
</li>
</ul>
</li>
<li>“VEE”
<ul>
<li>SH2 protein<br>
</li>
<li>SH2-SH3 protein<br>
</li>
</ul>
</li>
<li>“TRIANGLE”
<ul>
<li>SH3 protein<br>
</li>
</ul>
</li>
<li>“HEXAGON”
<ul>
<li>tyrosine kinase<br>
</li>
</ul>
</li>
<li>“DIAMOND”
<ul>
<li>SRC-family kinase<br>
</li>
</ul>
</li>
<li>“OCTAGON”
<ul>
<li>kinase<br>
</li>
<li>phosphatase<br>
</li>
</ul>
</li>
<li>“PARALLELOGRAM”
<ul>
<li>transcription factor<br>
</li>
</ul>
</li>
<li>“RECTANGLE”
<ul>
<li>RNA binding protein</li>
</ul>
</li>
</ul>
<p>Node Border Colors:</p>
<ul>
<li>Orange
<ul>
<li>deacetylase<br>
</li>
<li>acetyltransferase<br>
</li>
</ul>
</li>
<li>Blue
<ul>
<li>demethylase<br>
</li>
<li>methyltransferase<br>
</li>
</ul>
</li>
<li>Royal Purple
<ul>
<li>membrane protein<br>
</li>
</ul>
</li>
<li>Red
<ul>
<li>kinase<br>
</li>
<li>tyrosine kinase<br>
</li>
<li>SRC-family kinase<br>
</li>
</ul>
</li>
<li>Yellow
<ul>
<li>phosphatase<br>
</li>
<li>tyrosine phosphatase<br>
</li>
</ul>
</li>
<li>Lilac
<ul>
<li>G protein-coupled receptor<br>
</li>
<li>receptor tyrosine kinase<br>
</li>
</ul>
</li>
<li>Grey
<ul>
<li>default</li>
</ul>
</li>
</ul>
<p>Edge Colors:</p>
<ul>
<li>Red
<ul>
<li>Phosphorylation<br>
</li>
<li>pp<br>
</li>
<li>controls-phosphorylation-of<br>
</li>
</ul>
</li>
<li>Bright Magenta
<ul>
<li>controls-expression-of<br>
</li>
</ul>
</li>
<li>Dull Magenta
<ul>
<li>controls-transport-of<br>
</li>
</ul>
</li>
<li>Purple
<ul>
<li>controls-state-change-of<br>
</li>
</ul>
</li>
<li>Blood Orange
<ul>
<li>Acetylation<br>
</li>
</ul>
</li>
<li>Lime Green
<ul>
<li>Physical interactions<br>
</li>
</ul>
</li>
<li>Green
<ul>
<li>BioPlex<br>
</li>
</ul>
</li>
<li>Dull Green
<ul>
<li>in-complex-with<br>
</li>
</ul>
</li>
<li>Seafoam Green
<ul>
<li>experiments<br>
</li>
<li>experiments_transferred<br>
</li>
</ul>
</li>
<li>Cyan
<ul>
<li>database<br>
</li>
<li>database_transferred<br>
</li>
</ul>
</li>
<li>Teal
<ul>
<li>Pathway<br>
</li>
<li>Predicted<br>
</li>
</ul>
</li>
<li>Dark Turquoise
<ul>
<li>Genetic interactions<br>
</li>
</ul>
</li>
<li>Yellow-Orange
<ul>
<li>correlation<br>
</li>
</ul>
</li>
<li>Royal Blue
<ul>
<li>negative correlation<br>
</li>
</ul>
</li>
<li>Bright Yellow
<ul>
<li>positive correlation<br>
</li>
</ul>
</li>
<li>Grey
<ul>
<li>combined_score<br>
</li>
</ul>
</li>
<li>Dark Grey
<ul>
<li>merged<br>
</li>
</ul>
</li>
<li>Light Grey
<ul>
<li>intersect<br>
</li>
</ul>
</li>
<li>Black
<ul>
<li>peptide<br>
</li>
</ul>
</li>
<li>Orange
<ul>
<li>homology<br>
</li>
</ul>
</li>
<li>Dull Orange
<ul>
<li>Shared protein domains<br>
</li>
</ul>
</li>
<li>White
<ul>
<li>Default</li>
</ul>
</li>
</ul>
<p>Arrow Types:</p>
<ul>
<li>
<p>Arrow</p>
<ul>
<li>Phosphorylation<br>
</li>
<li>pp<br>
</li>
<li>controls-phosphorylation-of<br>
</li>
<li>controls-expression-of<br>
</li>
<li>controls-transport-of<br>
</li>
<li>controls-state-change-of<br>
</li>
<li>Acetylation<br>
</li>
</ul>
</li>
<li>
<p>No Arrow</p>
<ul>
<li>Default</li>
</ul>
<p>These properties can be visualized in Cytoscape</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">NodeEdgeKey</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># The edges have different weights, large weights can be too thick and smaller weights can result in very thin lines</span></span>
<span><span class="fu">setEdgeLineWidthMapping</span><span class="op">(</span><span class="st">'Weight'</span><span class="op">)</span></span>
<span><span class="co"># Edge widths can be adjusted using the following function. </span></span>
<span><span class="fu">setEdgeWidths</span><span class="op">(</span>ffactor <span class="op">=</span> <span class="fl">6</span>, log<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">#</span></span></code></pre></div>
</li>
</ul>
</div>
<div class="section level5">
<h5 id="estimated-run-time-8">Estimated run-time<a class="anchor" aria-label="anchor" href="#estimated-run-time-8"></a>
</h5>
<p>Depends on the size of the network</p>
<p>
 
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="post-processing-data">Post-Processing Data<a class="anchor" aria-label="anchor" href="#post-processing-data"></a>
</h2>
<p>This is a completely optional step for users that want to visualize
their data in different ways or interact with it in a desktop
environment.</p>
<div class="section level5">
<h5 id="as-an-igraph-object">As an igraph Object<a class="anchor" aria-label="anchor" href="#as-an-igraph-object"></a>
</h5>
<p>Most data structure outputs in this package are data frames or
matrices with columns of nodes and column(s) of weights. You will need
to view the data and manually set which two columns are the nodes and
which column is the edges. The following code creates an igraph named
graph.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">yourdatastructure</span></span>
<span><span class="va">nodecolumns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">edgecolumn</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span></span>
<span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span> <span class="va">df</span><span class="op">[</span>,<span class="va">nodecolumns</span><span class="op">]</span>, directed <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">)</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="saving-data">Saving Data<a class="anchor" aria-label="anchor" href="#saving-data"></a>
</h5>
<p>If you want to save your data to a file, all data structures can
either be exported with the save function and loaded later or saved to a
csv file with the write.csv function.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">object</span>, filename <span class="op">=</span> <span class="st">"filepath/name.rda"</span><span class="op">)</span> <span class="co"># Saves object as a .rda</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"filepath/name.rda"</span><span class="op">)</span>                    <span class="co"># Loads object saved to a file</span></span>
<span><span class="co"># For multiple objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">object1</span>, <span class="va">object2</span>, <span class="va">object.ect</span>, filename<span class="op">=</span><span class="st">"NewFile.RData"</span><span class="op">)</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">object</span>, file <span class="op">=</span> <span class="st">"filepath/name.csv"</span><span class="op">)</span> <span class="co"># Saves object as a .csv</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"filepath/name.csv"</span><span class="op">)</span>          <span class="co"># Loads object from .csv</span></span></code></pre></div>
<p>You may also save your entire Global Environment namespace using the
save.image function as shown below:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save.image</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"filepath/name.RData"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Grimes, Mikhail Ukrainetz, Grant Smith, Madison Moffett, Nagashree Avabhrath, Lucia Williams.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
