<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analyzing Pathways from PTMs: A Guide • PTMsToPathways</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing Pathways from PTMs: A Guide">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PTMsToPathways</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/PTMsToPathways.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Cytoscape_Graphing.html">Cytoscape_Graphing</a></li>
    <li><a class="dropdown-item" href="../articles/RawDataProcessing.html">Analyzing Pathways from PTMs: A Guide</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analyzing Pathways from PTMs: A Guide</h1>
                        <h4 data-toc-skip class="author">Nagashree
Avabhrath, Mikhail Ukrainetz, Madison Moffett, Grant Smith, Lucia
Williams, Mark Grimes</h4>
            
      

      <div class="d-none name"><code>PTMsToPathways.Rmd</code></div>
    </div>

    
    
<p>The PTMsToPathways (P2P) package takes Mass Spectrometry (MS) data of
protein post-translational modifications under different experimental
conditions and uses machine learning to identify PTM clusters that
represent functional modules in cell signaling. The clusters created
initially are then used to identify protein-protein interactions as well
as interactions between cell signaling pathways. This tutorial is
intended to be a step-by-step guide to walk users through the process of
using the PTMsToPathways (P2P) package. It includes descriptions of each
function and must be run in order as subsequent steps require the data
produced in previous steps. Example code and example outputs as well as
estimated run-times are included with each description and are based on
a preliminary dataset of ~9000 PTMs and 69 experimental conditions
processed with a 12th Gen i7 processor and 16GB of RAM.</p>
<p><strong>An important note:</strong> The returned outputs from the
functions are data that may be saved in an RData object so that the user
may reload the data, which may take a while to generate, and pick up
where they left off later. See the bottom of this document for code to
save your data efficiently.</p>
<div class="section level2">
<h2 id="installing-the-package">Installing the package<a class="anchor" aria-label="anchor" href="#installing-the-package"></a>
</h2>
<p>Ensure you have the latest version of RStudio and base R installed.
You will also need to install the devtools package, which can be
installed with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span></code></pre></div>
<p>Next, install the package with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"UM-Applied-Algorithms-Lab/PTMsToPathways"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="starting-data">Starting Data<a class="anchor" aria-label="anchor" href="#starting-data"></a>
</h2>
<p>For the tutorial, we will be using two example datasets: a smaller
dataset consisting of 933 PTMs and 18 experimental conditions (the
example used in the RawDataProcessing vignette) and a larger dataset
containing around 9000 PTMs and 69 experimental conditions. These
datasets are available with the package as a variable or can be
downloaded from our GitHub page <a href="https://github.com/UM-Applied-Algorithms-Lab/PTMsToPathways" class="external-link">PTMsToPathways</a>
to the user’s working directory and imported.</p>
<p>If you are using a smaller dataset, use the following code to view
the dimensions of the dataset and a small portion of it:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">dim</span>(ex_small_ptm_table)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>ex_small_ptm_table[<span class="dv">38</span><span class="sc">:</span><span class="dv">50</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="dv">908</span>  <span class="dv">18</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span>                            H3122SEPTM_pTyr.C1 H3122SEPTM_pTyr.C2</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> HNRNPA3 p S358                             <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> EPHB4 p S575                               <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> BCAR1 p S407                           <span class="dv">163730</span>             <span class="dv">159600</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> MAGOH p S38; MAGOHB p S40             <span class="dv">1824100</span>                 <span class="cn">NA</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> DYNLL1 p S64; DYNLL2 p S64                 <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> PRKCD p S304                               <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> PCDH1 p S1018                              <span class="cn">NA</span>             <span class="dv">563220</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> AHNAK p S5832                              <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> AHNAK p S5841                              <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ARHGEF5 p S1139                            <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> SRSF9 p S178                               <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> RIPK1 p S389                               <span class="cn">NA</span>                 <span class="cn">NA</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> URB2 p S18                                 <span class="cn">NA</span>                 <span class="cn">NA</span></span></code></pre></div>
<p>If you want to use the bigger dataset, the following code shows the
dimensions and a snippet of the dataset:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">dim</span>(ex_full_ptm_table)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>ex_full_ptm_table[<span class="dv">38</span><span class="sc">:</span><span class="dv">50</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="dv">9215</span>   <span class="dv">69</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span>                                H3122SEPTM.C1 H3122SEPTM.C2</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCC4 ubi K540                      <span class="fl">20.03456</span>            <span class="cn">NA</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCC4 ubi K622                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCC4 ubi K695                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCC4 ubi K77                             <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCC5 p Y10                               <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCD1 ubi K407; ABCD2 ubi K411            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCD3 ack K260                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCD3 ubi K260                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCD3 ubi K576                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCE1 ubi K121                      <span class="fl">17.62671</span>      <span class="fl">17.65533</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCE1 ubi K210                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCE1 ubi K250                            <span class="cn">NA</span>            <span class="cn">NA</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> ABCE1 ubi K93                             <span class="cn">NA</span>            <span class="cn">NA</span></span></code></pre></div>
<p>If you want to download the data and then import the dataset use the
following code:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># TO DO FIX THIS!!!!!</span></span>
<span><span class="va">allptmtable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"AlldataPTMs.txt"</span>, sep <span class="op">=</span> <span class="st">"\t"</span>, skip <span class="op">=</span> <span class="fl">0</span>, header <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          blank.lines.skip <span class="op">=</span> <span class="cn">T</span>, fill <span class="op">=</span> <span class="cn">T</span>, quote <span class="op">=</span> <span class="st">"\""</span>, dec <span class="op">=</span> <span class="st">"."</span>,</span>
<span>                          comment.char <span class="op">=</span> <span class="st">""</span>, stringsAsFactors <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="processing-the-data">Processing the data<a class="anchor" aria-label="anchor" href="#processing-the-data"></a>
</h2>
<p>The MS data needs to be transformed into a data frame with PTMs as
row names, experimental condition as column names, and numeric data as
the entries to carry out the analysis using P2P vignette. Please refer
to the RawDataProcessing Vignette for a tutorial showing all steps
needed to transform an MS output file into a P2P package input
dataframe.</p>
<div class="section level3">
<h3 id="step-1-make-cluster-list">Step 1: Make Cluster List<a class="anchor" aria-label="anchor" href="#step-1-make-cluster-list"></a>
</h3>
<p>MakeClusterList is the first step in the P2P process. This function
takes the dataframe PTM table and runs it through three calculations of
statistical measures of distance: Euclidean Distance, Spearman
Dissimilarity (1- |Spearman Correlation|), and SED (the average of both
Spearman Dissimilarity (1- Spearman Correlation) and Euclidean
Distance). Combining the two dissimilarities leads to better resolution
of the data and is useful in pattern recognition. A correlation table –
<em>ptm.correlation.matrix</em> – is generated based on the distances
calculated for each pair of PTMs. The function then runs the matrices
through t-SNE to generate clusters based on the previously calculated
distance and provides you with a cluster list, <em>common.clusters</em>.
The returned <em>adj.consensus</em> (which identifies which PTMs cluster
together with a ‘short distance’ between them) and
<em>ptm.correlation.matrix</em> are also used in the next step to create
co-cluster correlation networks (CCCNs).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Set seed to obtain repeatable t-SNE graphs</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">88</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>clusterlist.data <span class="ot">&lt;-</span> <span class="fu">MakeClusterList</span>(ex_small_ptm_table, <span class="at">keeplength =</span> <span class="dv">2</span>, <span class="at">toolong =</span> <span class="fl">3.5</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Starting correlation calculations and t<span class="sc">-</span>SNE.</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> This may take a few minutes or hours <span class="cf">for</span> large data sets.</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Spearman correlation calculation complete after <span class="fl">13.47</span> secs total.</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Spearman t<span class="sc">-</span>SNE calculation complete after <span class="fl">42.56</span> secs total.</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Euclidean distance calculation complete after <span class="fl">42.6</span> secs total.</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Euclidean t<span class="sc">-</span>SNE calculation complete after <span class="fl">1.15</span> mins total.</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Combined distance calculation complete after <span class="fl">1.15</span> mins total.</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> SED t<span class="sc">-</span>SNE calculation complete after <span class="fl">1.6</span> mins total.</span></code></pre></div>
<p><img src="plots/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;"></p>
<pre><code>&gt;&gt; Clustering for Euclidean complete after 1.62 mins total.</code></pre>
<p><img src="plots/unnamed-chunk-6-2.png" width="100%" style="display: block; margin: auto;"></p>
<pre><code>&gt;&gt; Clustering for Spearman complete after 1.62 mins total.</code></pre>
<p><img src="plots/unnamed-chunk-6-3.png" width="100%" style="display: block; margin: auto;"></p>
<pre><code>&gt;&gt; Clustering for SED complete after 1.62 mins total.
&gt;&gt; Consensus clustering complete after 1.63 mins total.
&gt;&gt; MakeClusterList complete after 1.63 mins total.

# The following code unpacks the output into separate objects:
common.clusters &lt;- clusterlist.data[[1]]
adj.consensus &lt;- clusterlist.data[[2]]
ptm.correlation.matrix &lt;- clusterlist.data[[3]]

# Now we can view the objects:
print("This is an example of a cluster:")
common.clusters[1]
print("This is a piece of the adj.consensus table; Ones represent a pair that cluster and zeroes represent a pair that doesn't:")
adj.consensus[1:5, 1:2]
print("This is part of the ptm.correlation.matrix:")
ptm.correlation.matrix[38:43, 1:2]
&gt;&gt; [1] "This is an example of a cluster:"
&gt;&gt; $ConsensusCluster1
&gt;&gt; [1] "KRT7 p S37"                              
&gt;&gt; [2] "CALM3 p Y100; CALM2 p Y100; CALM1 p Y100"
&gt;&gt; [3] "ERP29 p Y66"                             
&gt;&gt; [4] "MYH9 p Y1408"                            
&gt;&gt; [5] "PTK2 p Y925"                             
&gt;&gt; [6] "TNK2 p Y827"                             
&gt;&gt; [7] "ITSN2 p Y553"                            
&gt;&gt; [8] "PRRC2C p Y1218"                          
&gt;&gt; 
&gt;&gt; [1] "This is a piece of the adj.consensus table; Ones represent a pair that cluster and zeroes represent a pair that doesn't:"
&gt;&gt;               KRT7 p S37 KRT7 p S38
&gt;&gt; KRT7 p S37             0          0
&gt;&gt; KRT7 p S38             0          0
&gt;&gt; INPPL1 p S890          0          0
&gt;&gt; KDM6A p S388           0          0
&gt;&gt; DIAPH1 p S373          0          0
&gt;&gt; [1] "This is part of the ptm.correlation.matrix:"
&gt;&gt;                            KRT7 p S37 KRT7 p S38
&gt;&gt; HNRNPA3 p S358                     NA         NA
&gt;&gt; EPHB4 p S575                       NA         NA
&gt;&gt; BCAR1 p S407                0.5868132        0.5
&gt;&gt; MAGOH p S38; MAGOHB p S40   1.0000000         NA
&gt;&gt; DYNLL1 p S64; DYNLL2 p S64 -0.8000000         NA
&gt;&gt; PRKCD p S304                0.8571429         NA</code></pre>
<p><strong>Note:</strong> t-SNE involves an element of randomness due to
pseudorandom initialization or stochastic processes within the
algorithm; in order to get the same results on multiple executions,
set.seed(#) must be called (# = any integer of choice). The variable
<em>toolong</em> manipulates the size of the cluster and is set at 3.5.
This is recommended as a good starting point for t-SNE but can be
changed as per the researcher’s discretion. This function may take
upwards of an hour to run, so it is recommended that the output is saved
as an RData object which can then be imported.</p>
<div class="section level5">
<h5 id="estimated-run-time">Estimated run-time<a class="anchor" aria-label="anchor" href="#estimated-run-time"></a>
</h5>
<p>~60min</p>
</div>
</div>
<div class="section level3">
<h3 id="step-2-make-co-cluster-correlation-networks-ptm-and-gene">Step 2: Make Co-Cluster Correlation Networks (PTM and Gene)<a class="anchor" aria-label="anchor" href="#step-2-make-co-cluster-correlation-networks-ptm-and-gene"></a>
</h3>
<p>The cluster list generated in the previous step is next used to
create a new network of PTMs that have strong associations called the
Co-cluster Correlation Network (CCCN). The Spearman correlations between
co-clustered PTMs are used as edge-weights in this network. The
MakeCorrelationNetwork function groups the PTM correlation matrices by
PTMs that co-cluster together to create a PTM CCCN. It then defines a
relationship between proteins modified by PTMs and creates a gene CCCN
with sum of the PTM correlations serving as edge weights. The output of
this function can be saved as an RData object.</p>
<p>In addition to CCCN edge lists, this function also returns igraph
object gene.cccn.g. This object can be used later to plot, extract edge
lists or adjacency matrices, and accomplish many other functions
available from the igraph package.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>CCCN.data <span class="ot">&lt;-</span> <span class="fu">MakeCorrelationNetwork</span>(adj.consensus, ptm.correlation.matrix)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>ptm.cccn.edges <span class="ot">&lt;-</span> CCCN.data[[<span class="dv">1</span>]]  <span class="co"># PTM CCCN edge list</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>gene.cccn.edges <span class="ot">&lt;-</span> CCCN.data[[<span class="dv">2</span>]] <span class="co"># Gene CCCN edge list</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>gene.cccn.nodes <span class="ot">&lt;-</span> CCCN.data[[<span class="dv">3</span>]] <span class="co"># List of nodes in the CCCN</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                                  <span class="co"># used to gather PPI data from external databases</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>ptm.cccn.edges[<span class="dv">18</span><span class="sc">:</span><span class="dv">22</span>,]</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>gene.cccn.edges[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>gene.cccn.nodes[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="st">"Making PTM CCCN"</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="st">"2025-10-31 01:07:35 UTC"</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] Total time<span class="sc">:</span> <span class="fl">0.0393147468566895</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="st">"Making Gene CCCN"</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="st">"2025-10-31 01:07:35 UTC"</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="st">"2025-10-31 01:07:37 UTC"</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] Total time<span class="sc">:</span> <span class="fl">1.81975626945496</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span>           source        target     Weight          interaction</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">18</span> EIF2B1 p S131   PKP4 p S273 <span class="sc">-</span><span class="fl">0.6833333</span> negative correlation</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">19</span>   LDHB p S238   EML4 p S242 <span class="sc">-</span><span class="fl">1.0000000</span> negative correlation</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">20</span> S100A16 p S27   EML4 p S242 <span class="sc">-</span><span class="fl">0.5000000</span> negative correlation</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">21</span>     PXN p S90 S100A14 p S33 <span class="sc">-</span><span class="fl">0.3571429</span>          correlation</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">22</span>    URB2 p S18 SHANK2 p S589  <span class="fl">0.5428571</span> positive correlation</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span>   source target     Weight          interaction</span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">1</span> ADGRL2  ALDOA <span class="sc">-</span><span class="fl">0.4535714</span>          correlation</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">2</span>   ACP1    ALK  <span class="fl">0.6000000</span> positive correlation</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">3</span>  AHNAK   ANO1  <span class="fl">1.5428571</span> positive correlation</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">4</span>   ACP1  ANXA2 <span class="sc">-</span><span class="fl">0.2571429</span>          correlation</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> <span class="dv">5</span> ADAM10  ANXA2  <span class="fl">0.1702786</span>          correlation</span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> [<span class="dv">1</span>] <span class="st">"ADGRL2"</span> <span class="st">"ACP1"</span>   <span class="st">"AHNAK"</span>  <span class="st">"ADAM10"</span> <span class="st">"ALDOA"</span></span></code></pre></div>
<div class="section level5">
<h5 id="estimated-run-time-1">Estimated run-time<a class="anchor" aria-label="anchor" href="#estimated-run-time-1"></a>
</h5>
<p>~10min</p>
</div>
</div>
<div class="section level3">
<h3 id="step-3-retrieve-database-edgefiles">Step 3: Retrieve Database Edgefiles<a class="anchor" aria-label="anchor" href="#step-3-retrieve-database-edgefiles"></a>
</h3>
<p>The third step of the P2P package requires the use of multiple
protein-protein interaction (PPI) databases. The data is used to
generate a PPI network where proteins are nodes, and their interactions
are edges and represent all known interactions observed in a wide range
of cell types, disease states, and environmental conditions. The P2P
package explicitly allows the users to integrate data from three
external databases: STRING, GeneMANIA, and PhosphoSite Plus. Other
databases can also be downloaded and added to the PPI network. All three
external databases have different interfaces for downloading data.</p>
<div class="section level4">
<h4 id="stringdb">1. STRINGdb<a class="anchor" aria-label="anchor" href="#stringdb"></a>
</h4>
<p>STRINGdb has its own R package, making this the easiest database to
pull from. The database will automatically be queried by the GetSTRINGdb
function. Its output is then filtered by interaction type so only
experimental, database, and experimental_transferred and
database_transferred are retained. This ensures that only interactions
with more substantial evidence are used in this analysis.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>stringdb.edges <span class="ot">&lt;-</span> <span class="fu">GetSTRINGdb</span>(gene.cccn.edges, gene.cccn.nodes)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>stringdb.edges[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;</span> Warning<span class="sc">:</span>  we couldn<span class="st">'t map to STRING 0% of your identifiers   source target              interaction Weight</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="st">&gt;&gt; 21 MAPK13 MAPK12                 database   1128</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="st">&gt;&gt; 31 MAPK12  MAPK1                 database   1182</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="st">&gt;&gt; 35 GPRC5A   MYH9             experimental    164</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="st">&gt;&gt; 41   MISP   MYH9             experimental    148</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="st">&gt;&gt; 71   MYH9 PIK3R2 experimental_transferred    216</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="genemania">2. GeneMANIA<a class="anchor" aria-label="anchor" href="#genemania"></a>
</h4>
<p>To our knowledge, no R package exists to programmatically query
GeneMANIA. Thus, utilizing the data from GeneMANIA involves two steps:
first generating the input the file and then processing the output file.
Please be aware that this requires downloading the <a href="https://cytoscape.org/download.html" class="external-link">Cytoscape app</a> and then
installing the <a href="https://apps.cytoscape.org/apps/genemania" class="external-link">GeneMANIA
extension</a>. The MakeDBInput function allows us to automatically
generate an input file that can be copy and pasted into the query box in
GeneMANIA from within the Cytoscape app.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MakeDBInput.html">MakeDBInput</a></span><span class="op">(</span><span class="va">gene.cccn.nodes</span>, file.path.name <span class="op">=</span> <span class="st">"db_nodes.txt"</span><span class="op">)</span></span></code></pre></div>
<p>The ProcessGMEdgefile function then processes the output files
produced by GeneMANIA itself.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genemania.edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ProcessGMEdgefile.html">ProcessGMEdgefile</a></span><span class="op">(</span><span class="va">gm.edgefile.path</span>, <span class="va">gm.nodetable.path</span>,</span>
<span>                                     <span class="va">db_nodes.path</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="phosphosite-plus">3. Phosphosite Plus<a class="anchor" aria-label="anchor" href="#phosphosite-plus"></a>
</h4>
<p>The kinase-substrate data can be downloaded from <a href="https://www.phosphosite.org/staticDownloads" class="external-link">Phosphosite Plus</a>
database. The users will be required to create an account and sign in to
download the data. The format.kinsub.table function reads this
downloaded data in and formats it so that all the PPI edge data frames
are in the same format for the next step.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kinsub.edges</span> <span class="op">&lt;-</span> <span class="fu">format.kinsub.table</span><span class="op">(</span>kinasesubstrate.filename <span class="op">=</span></span>
<span>                                      <span class="st">"Kinase_Substrate_Dataset.txt"</span>,</span>
<span>                                    <span class="va">gene.cccn.nodes</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="step-4-build-ppi-network-and-cluster-filtered-network">Step 4: Build PPI Network and Cluster Filtered Network<a class="anchor" aria-label="anchor" href="#step-4-build-ppi-network-and-cluster-filtered-network"></a>
</h3>
<p>The BuildClusterFilteredNetwork function allows the users to filter
protein-protein interaction networks using the previously generated
cocluster correlation networks. PPIs are retained in the cluster
filtered network (cfn) only if the interacting proteins share
statistically correlated PTMs identified via t-SNE clusters. The
BuildClusterFilteredNetwork function combines all the PPI data
downloaded in step 3 as efficiently as possible while retaining the
desired edge weights. It then normalizes the weights on a scale of 0-1
and gives an output cluster filter network that will only retain
interacting proteins whose genes are within the co-cluster correlation
network created in step 2.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">network.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BuildClusterFilteredNetwork.html">BuildClusterFilteredNetwork</a></span><span class="op">(</span><span class="va">stringdb.edges</span>, <span class="va">genemania.edges</span>,</span>
<span>                                            <span class="va">kinsub.edges</span>, <span class="va">gene.cccn.edges</span>,</span>
<span>                                            db.filepaths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">combined.PPIs</span> <span class="op">&lt;-</span> <span class="va">network.list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">cfn</span> <span class="op">&lt;-</span> <span class="va">network.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># To reduce clutter on graphs, the cfn edges can be merged:</span></span>
<span><span class="va">cfn.merged</span> <span class="op">&lt;-</span> <span class="fu">mergeEdges</span><span class="op">(</span><span class="va">cfn</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-5-pathway-crosstalk-network">Step 5: Pathway Crosstalk Network<a class="anchor" aria-label="anchor" href="#step-5-pathway-crosstalk-network"></a>
</h3>
<p><strong>Note:</strong> This step is directory sensitive. The user can
check and set the working directory in R using getwd() and
setwd(“yourdirectoryhere”) respectively. It needs a path to the
bioplanet file and will put an edgelist file in the working directory or
the otherwise given path. If the file cannot be found, please check the
working directory first.</p>
<p>Our final analysis step is the Pathway Crosstalk Network (PCN). This
step requires input of an external database from <a href="https://tripod.nih.gov/bioplanet/download/pathway.csv" class="external-link">NCATS
BioPlanet</a>, that contains groups of genes (proteins) involved in
various cellular processes known as pathways. PCN turns this data file
into a list of pathways and converts those pathways into a pathway x
pathway edgelist (PCNedgelist) that possesses multiple weights, a
jaccard similarity, and a score. The score is derived from
Cluster-Pathway Evidence using the common clusters found in Make
Correlation Network. Info about the Cluster-Pathway Evidence score can
be found <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010690" class="external-link">here</a>
For graphing in Cytoscape, the Cluster-Pathway Evidence and Jaccard
similarity edges are listed separately in the edgelist called
pathway.crosstalk.network.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PCN.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PathwayCrosstalkNetwork.html">PathwayCrosstalkNetwork</a></span><span class="op">(</span><span class="va">common.clusters</span>, bioplanet.file <span class="op">=</span> <span class="st">"pathway.csv"</span>,</span>
<span>                                    createfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pathway.crosstalk.network</span> <span class="op">&lt;-</span> <span class="va">PCN.data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">PCNedgelist</span> <span class="op">&lt;-</span> <span class="va">PCN.data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">pathways.list</span> <span class="op">&lt;-</span> <span class="va">PCN.data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="saving-data">Saving Data<a class="anchor" aria-label="anchor" href="#saving-data"></a>
</h2>
<p>If you want to save your data to a file, all data structures can
either be exported with the save function and loaded later or saved to a
csv file with the write.csv function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For one object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">object</span>, filename <span class="op">=</span> <span class="st">"filepath/name.rda"</span><span class="op">)</span> <span class="co"># Saves object as an .rda</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"filepath/name.rda"</span><span class="op">)</span>                    <span class="co"># Loads object saved to a file</span></span>
<span></span>
<span><span class="co"># For multiple objects: Note the objects are saved as an .RData rather than an .rda</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">object1</span>, <span class="va">object2</span>, <span class="va">object.ect</span>, filename<span class="op">=</span><span class="st">"NewFile.RData"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># One object as a csv</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">object</span>, file <span class="op">=</span> <span class="st">"filepath/name.csv"</span><span class="op">)</span> <span class="co"># Saves object as a .csv</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"filepath/name.csv"</span><span class="op">)</span>          <span class="co"># Loads object from .csv</span></span></code></pre></div>
<p>You may also save your entire Global Environment namespace using the
save.image function as shown below:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save.image</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"filepath/name.RData"</span><span class="op">)</span> <span class="co"># All objects in the environment are saved</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Grimes, Mikhail Ukrainetz, Grant Smith, Madison Moffett, Nagashree Avabhrath, Lucia Williams.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
